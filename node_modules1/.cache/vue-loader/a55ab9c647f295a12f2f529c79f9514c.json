{"remainingRequest":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\src\\components\\operatingFunc\\vehicleEntryExitLive.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\src\\components\\operatingFunc\\vehicleEntryExitLive.vue","mtime":1603940790022},{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\OneDrive\\bae\\manned_parking\\02_ADMIN\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb25maWcgZnJvbSAiLi4vLi4vY29uZmlnLmpzIgppbXBvcnQgeyBtYXBTdGF0ZSB9IGZyb20gInZ1ZXgiCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGRhdGFMaXN0OiBbe2dldF90aW1lOiLspIDruYTspJEiLGdldF9sb2NhdGlvbjoi7KSA67mE7KSRIixnZXRfZGlyZWN0aW9uOiLspIDruYTspJEiLGdldF9scDoi7KSA67mE7KSRIixnZXRfZmVlOiLspIDruYTspJEiLGdldF9kaXNjb3VudGVkX2ZlZToi7KSA67mE7KSRIixnZXRfcGFpZF9mZWU6IuykgOu5hOykkSIsZ2V0X3JlZ2lzdGVyZWQ6IuykgOu5hOykkSIsZ2V0X2NvbnRlbnRzOiLspIDruYTspJEifV0sCiAgICAgIGNhcm1lcmFfbGlzdDogWyAgIHsKICAgICAga2luZF9iYXJfc3RhdHVzOiAiYmFycmllcl9zdGF0dXMiLAogICAgICBraW5kX2Jhcl9wb2xpY3k6ICJiYXJfcGxvaWN5IiwKICAgICAgc3RhdHVzOiAiZG93biIsCiAgICAgIGxvY2F0aW9uOiAi7KCV66y47J6F6rWsIiwKICAgICAgZGlyZWN0aW9uOiAiaW4iLAogICAgICBscDogIjEyM+qwgDQ1NjciLAogICAgICBpbWFnZV9kaXNwbGF5OiBmYWxzZSwKICAgICAgYmFycmllcl9jb250cm9sX2Rpc3BsYXk6IHRydWUsCiAgICAgIGJhcnJpZXJfcG9saWN5X25hbWU6ICJiYXJyaWVyX3BvbGljeTEiLAogICAgICBpbWFnZV9uYW1lOiByZXF1aXJlKCIuLi8uLi9hc3NldHMvY2FyX3Rlc3QxLmpwZyIpLAogICAgICBjaGVja2VkTmFtZXM6ICJhbGxfdmVoaWNsZSIKICAgIH0sCiAgICB7CiAgICAgIGtpbmQ6ICJiYXJyaWVyX3N0YXR1cyIsCiAgICAgIHN0YXR1czogImRvd24iLAogICAgICBsb2NhdGlvbjogIuygleusuOy2nOq1rCIsCiAgICAgIGRpcmVjdGlvbjogIm91dCIsCiAgICAgIGxwOiAiNTQ26rCAMTUxNyIsCiAgICAgIGltYWdlX2Rpc3BsYXk6IGZhbHNlLAogICAgICBiYXJyaWVyX2NvbnRyb2xfZGlzcGxheTogdHJ1ZSwKICAgICAgYmFycmllcl9wb2xpY3lfbmFtZTogImJhcnJpZXJfcG9saWN5MiIsCiAgICAgIGltYWdlX25hbWU6IHJlcXVpcmUoIi4uLy4uL2Fzc2V0cy9jYXJfdGVzdDIuanBnIiksCiAgICAgIGNoZWNrZWROYW1lczogInJlZ2lzdGVyZWRfdmVoaWNsZSIgICAgIAogICAgfV0sCiAgICAgIHN0YXJ0X3RpbWU6IG5ldyBEYXRlKCksCiAgICAgIGVuZF90aW1lOiBuZXcgRGF0ZSgpLAogICAgICB0b3RhbF9wYXJraW5nX2ZlZTogMCwKICAgICAgdG90YWxfZGlzY291bnRlZF9mZWU6IDAsCiAgICAgIHRvdGFsX3BhaWRfZmVlOiAwLAogICAgICB0b2dnbGU6IGZhbHNlLAogICAgICBvcGVuZml4OiBmYWxzZSwKICAgICAgbm9zaWduYWw6IGZhbHNlLAogICAgICBsaXN0X2l0ZW1zOiB7CiAgICAgICAgdGltZTogIu2YhOyerOyLnOqwhCIsCiAgICAgICAgbG9vcF9ldmVudF90aW1lOiAicGPsi5zqsIQiLAogICAgICAgIGxvY2F0aW9uOiAiMeq1rOyXrSIsCiAgICAgICAgZGlyZWN0aW9uOiAiSW4iLAogICAgICAgIGxwOiAiMTIz6rCANDU2NyIsCiAgICAgICAgcmVzaXN0ZXJlZDogIuuTseuhneywqOufiSIsCiAgICAgICAgZG9uZ19obzogIjEwMeuPmSIsCiAgICAgICAgaW1hZ2VfZGlzcGxheTogZmFsc2UsCiAgICAgICAgaW1hZ2VfbmFtZTogcmVxdWlyZSgiLi4vLi4vYXNzZXRzL2Nhcl90ZXN0NC5qcGciKQogICAgICB9LAogICAgICBjaGVja2VkOiBbXSwKICAgICAgYnV0dG9uX3ZhbHVlOiBbCiAgICAgICAgeyBuYW1lOiAi6rCc67CpIiwgY2hlY2tlZDogdHJ1ZSB9LAogICAgICAgIHsgbmFtZTogIu2SgOumvCIsIGNoZWNrZWQ6IGZhbHNlIH0KICAgICAgXQogICAgfQogIH0sCiAgZmlsdGVyczogewogICAgY3VycmVuY3k6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHZhciBudW0gPSBuZXcgTnVtYmVyKHZhbHVlKQogICAgICByZXR1cm4gbnVtLnRvRml4ZWQoMCkucmVwbGFjZSgvKFxkKSg/PShcZHszfSkrKD86XC5cZCspPyQpL2csICIkMSwiKQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgICAuLi5tYXBTdGF0ZShbIm1haW5UaXRsZSJdKSwKICAgIGNvdW50X2luKCkgewogICAgICBsZXQgY291bnQgPSAwCiAgICAgIHRoaXMuZGF0YUxpc3QuZm9yRWFjaChjb3QgPT4gewogICAgICAgIGlmIChjb3QuZ2V0X2RpcmVjdGlvbiA9PT0gImluIikgY291bnQrKwogICAgICB9KQogICAgICByZXR1cm4gY291bnQKICAgIH0sCiAgICBjb3VudF9vdXQoKSB7CiAgICAgIGxldCBjb3VudCA9IDAKICAgICAgdGhpcy5kYXRhTGlzdC5mb3JFYWNoKGNvdCA9PiB7CiAgICAgICAgaWYgKGNvdC5nZXRfZGlyZWN0aW9uID09PSAib3V0IikgY291bnQrKwogICAgICB9KQogICAgICByZXR1cm4gY291bnQKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLiRzb2NrZXQub24oIm1lc3NhZ2VfZnJvbV9zZXJ2ZXIiLCBkYXRhID0+IHsgICAgICAgICAKICAgICAgdGhpcy5scHJfcHJvY2VzcyhkYXRhKQogICAgfSksCiAgICAgIHRoaXMuYmFycmllcl9uYW1lX2NoZWNrKCksCiAgICAgIC8vIHRoaXMuYmFycmllcl9wb2xpY3lfcXVlcnkoKSwKICAgICAgLy90aGlzLmJhcl9zdGF0dXNfcXVlcnkoKSwKICAgICAgdGhpcy5zdGFydCgpLAogICAgICB0aGlzLnZlaGljbGVfb2JqX2xpc3RfZmluZCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBscHJfcHJvY2VzcyhkYXRhMSkgewogICAgICBpZiAoZGF0YTEua2luZCA9PT0gImJhcnJpZXJfc3RhdHVzIikgewogICAgICAgIGNvbnNvbGUubG9nKCJiYXJyaWVyX3N0YXR1cyIsIGRhdGExKQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChkYXRhMS5sb2NhdGlvbiA9PSB0aGlzLmNhcm1lcmFfbGlzdFtpXS5sb2NhdGlvbikgewogICAgICAgICAgICBpZiAoZGF0YTEuc3RhdHVzID09PSAiZG93biIgfHwgZGF0YTEuc3RhdHVzID09PSAiRE9XTiIpIHsKICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtpXS5pbWFnZV9kaXNwbGF5ID0gZmFsc2UKICAgICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3QucHVzaCh0ZW1wKQogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnNwbGljZSh0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGggLSAxLCAxKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLmltYWdlX2Rpc3BsYXkgPSB0cnVlCiAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnB1c2godGVtcCkKICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09PSAiYmFyX21vZGUiKSB7CiAgICAgICAgY29uc29sZS5sb2coImJhcl9tb2RlIiwgZGF0YTEpCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkYXRhMS5kb2NzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBsZXQgYmFyX21vZGUgPSBkYXRhMS5kb2NzW2pdCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBiYXJfbW9kZS5sb2NhdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0ubG9jYXRpb24gJiYgIGJhcl9tb2RlLmRpcmVjdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0uZGlyZWN0aW9uCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmIChiYXJfbW9kZS5tb2RlID09PSAibG9jayIpIHsKICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLm9wZW5maXggPSB0cnVlCiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3RbaV0ub3BlbmZpeCA9IGZhbHNlCiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09PSAiYmFyX3N0YXR1cyIpIHsKICAgICAgICBjb25zb2xlLmxvZygiYmFyX3N0YXR1cyIsIGRhdGExKQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZGF0YTEuZG9jcy5sZW5ndGg7IGorKykgewogICAgICAgICAgbGV0IGJhcl9zdGF0dXMgPSBkYXRhMS5kb2NzW2pdCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBiYXJfc3RhdHVzLmxvY2F0aW9uID09PSB0aGlzLmNhcm1lcmFfbGlzdFtpXS5sb2NhdGlvbiAmJgogICAgICAgICAgICAgIGJhcl9zdGF0dXMuZGlyZWN0aW9uID09IHRoaXMuY2FybWVyYV9saXN0W2ldLmRpcmVjdGlvbgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBpZiAoZGF0YTEuc3RhdHVzID09PSAiZG93biIgfHwgZGF0YTEuc3RhdHVzID09PSAiRE9XTiIpIHsKICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLmltYWdlX2Rpc3BsYXkgPSBmYWxzZQogICAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3QucHVzaCh0ZW1wKQogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3Quc3BsaWNlKHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCAtIDEsIDEpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhMS5zdGF0dXMgPT09ICJ1cCIgfHwgZGF0YTEuc3RhdHVzID09PSAiVVAiKXsKICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLmltYWdlX2Rpc3BsYXkgPSB0cnVlCiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09PSAic29ja2V0X2Vycm9yIikgewogICAgICAgIC8vICBjb25zb2xlLmxvZygic29ja2V0IGVycm9yIDogIiwgZGF0YTEpCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgICBkYXRhMS5sb2NhdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0ubG9jYXRpb24gJiYKICAgICAgICAgICAgZGF0YTEuZGlyZWN0aW9uID09PSB0aGlzLmNhcm1lcmFfbGlzdFtpXS5kaXJlY3Rpb24KICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtpXS5ub3NpZ25hbCA9IHRydWUKICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnNwbGljZSh0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGggLSAxLCAxKQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCLrs7TrgrzqsJIiLCB0aGlzLmNhcm1lcmFfbGlzdFswXS5zdGF0dXMpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGExLmtpbmQgPT09ICJ3ZWVrbHlfYmFycmllcl9wb2xpY3kiKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgICBkYXRhMS5sb2NhdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0ubG9jYXRpb24gJiYKICAgICAgICAgICAgZGF0YTEuZGlyZWN0aW9uID09PSB0aGlzLmNhcm1lcmFfbGlzdFtpXS5kaXJlY3Rpb24KICAgICAgICAgICkgewogICAgICAgICAgICBpZiAoZGF0YTEuYmFycmllcl9wb2xpY3kgPT09ICLqsJzrsKkiKSB7CiAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3RbaV0uY2hlY2tlZE5hbWVzID0gImFsbF92ZWhpY2xlIgogICAgICAgICAgICAgIGxldCB0ZW1wID0ge30KICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3Quc3BsaWNlKHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCAtIDEsIDEpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjb25maWcuYmFycmllcl9kaXNwbGF5X2xpc3QubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgZGF0YTEubG9jYXRpb24gPT09IGNvbmZpZy5iYXJyaWVyX2Rpc3BsYXlfbGlzdFtqXS5sb2NhdGlvbiAmJgogICAgICAgICAgICAgICAgICBkYXRhMS5kaXJlY3Rpb24gPT09IGNvbmZpZy5iYXJyaWVyX2Rpc3BsYXlfbGlzdFtqXS5kaXJlY3Rpb24KICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtpXS5jaGVja2VkTmFtZXMgPQogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5iYXJyaWVyX2Rpc3BsYXlfbGlzdFtqXS5jaGVja2VkTmFtZXMKICAgICAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5wdXNoKHRlbXApCiAgICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnNwbGljZSh0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGggLSAxLCAxKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09PSAic29ja2V0X25vcm1hbCIpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZygic29ja2V0IG5vcm1hbCA6ICIsIGRhdGExKQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZGF0YTEubG9jYXRpb24gPT09IHRoaXMuY2FybWVyYV9saXN0W2ldLmxvY2F0aW9uICYmCiAgICAgICAgICAgIGRhdGExLmRpcmVjdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0uZGlyZWN0aW9uCiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3RbaV0ubm9zaWduYWwgPSBmYWxzZQogICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnB1c2godGVtcCkKICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3Quc3BsaWNlKHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCAtIDEsIDEpCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIuuztOuCvOqwkiIsIHRoaXMuY2FybWVyYV9saXN0WzBdLnN0YXR1cykKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGF0YTEua2luZCA9PSAibHByIikgewogICAgICAgIGNvbnNvbGUubG9nKGRhdGExLmtpbmQsIGRhdGExKQogICAgICAgIC8vdmFyIGltYWdlX25hbWUgPSAibG9jYWxob3N0OjcyMDAvaW1hZ2VzLyIrZGF0YTEuZm9sZGVyX25hbWUrIi8iK2RhdGExLmZpbGVuYW1lCiAgICAgICAgbGV0IGltYWdlX25hbWUgPQogICAgICAgICAgY29uZmlnLmltYWdlX3NyYyArIGRhdGExLmZvbGRlcl9uYW1lICsgIi8iICsgZGF0YTEuZmlsZW5hbWUKICAgICAgICAvLyBjb25zb2xlLmxvZygiaW1hZ2VfbmFtZSA6ICIsIGltYWdlX25hbWUpCiAgICAgICAgLy8JY29uc29sZS5sb2coImRhdGFMaXN0IDogIiwgdGhpcy5kYXRhTGlzdCk7CiAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgZGF0YTEuZGlyZWN0aW9uMSA9ICJpbiIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YTEuZGlyZWN0aW9uMSA9ICJvdXQiCiAgICAgICAgfQogICAgICAgIGxldCBmbGFnID0gZmFsc2UKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF0YUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5kYXRhTGlzdFtpXS5nZXRfbG9vcF9ldmVudF90aW1lLCB0aGlzLmRhdGFMaXN0W2ldLmdldF9scCk7CiAgICAgICAgICBpZiAodGhpcy5kYXRhTGlzdFtpXS5nZXRfbG9vcF9ldmVudF90aW1lID09PSBkYXRhMS5sb29wX2V2ZW50X3RpbWUpIHsKICAgICAgICAgICAgaWYgKGRhdGExLmxwICE9ICLrr7jsnbjsi50iKSB7CiAgICAgICAgICAgICAgLy8g65Ok7Ja07JioIOywqOufieydtCDrr7jsnbjsi53snbQg7JWE64uI66m0CiAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xwID09PSAi66+47J247IudIikgewogICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHAgPSBkYXRhMS5scAogICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcmVnaXN0ZXJlZCA9IGRhdGExLnJlZ2lzdGVyZWQKICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2RpcmVjdGlvbiA9IGRhdGExLmRpcmVjdGlvbjEKICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2NvbnRlbnRzID0gZGF0YTEuY29udGVudHMKICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ltYWdlX25hbWUgPSB0cnVlCiAgICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9pbWFnZV9uYW1lID0gaW1hZ2VfbmFtZQogICAgICAgICAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUgPSAwCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ZlZSA9IDAKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGlmICghZGF0YTEuZGlzY291bnRlZF9mZWUpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhMS5kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoIWRhdGExLmZlZSB8fCBkYXRhMS5mZWUgPT09IDk5OTggfHwgZGF0YTEuZmVlID09PSA5OTk5KSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YTEuZmVlID0gMAogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmICghZGF0YTEuZmVlIHx8IGRhdGExLmZlZSA9PT0gOTk5OCB8fCBkYXRhMS5mZWUgPT09IDk5OTkpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhMS5wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZmxhZyA9PT0gdHJ1ZSA6IiwgZGF0YTEpCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2Rpc2NvdW50ZWRfZmVlID0gcGFyc2VJbnQoCiAgICAgICAgICAgICAgICAgICAgZGF0YTEuZGlzY291bnRlZF9mZWUsCiAgICAgICAgICAgICAgICAgICAgMTAKICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9wYWlkX2ZlZSA9IHBhcnNlSW50KGRhdGExLnBhaWRfZmVlLCAxMCkKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZmVlID0gcGFyc2VJbnQoZGF0YTEuZmVlLCAxMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgLy8JY29uc29sZS5sb2coZGF0YTEubHAsIHRoaXMuY2FybWVyYV9saXN0W2ldLmxvY2F0aW9uLCBkYXRhMS5sb2NhdGlvbik7CiAgICAgICAgICAgICAgICAgIGlmIChkYXRhMS5sb2NhdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0ubG9jYXRpb24gJiYgZGF0YTEuZGlyZWN0aW9uID09PSB0aGlzLmNhcm1lcmFfbGlzdFtpXS5kaXJlY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtpXS5scCA9IGRhdGExLmxwCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3RbaV0uaW1hZ2VfbmFtZSA9IGltYWdlX25hbWUKICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3QucHVzaCh0ZW1wKQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnNwbGljZSh0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGggLSAxLCAxKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZmxhZyA9IHRydWUKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGZsYWcgPT0gZmFsc2UpIHsKICAgICAgICAgIGxldCB0ZW1wID0ge30KICAgICAgICAgIHRlbXAuZ2V0X3RpbWUgPSBmb3JtYXRfdGltZShuZXcgRGF0ZShkYXRhMS5sb29wX2V2ZW50X3RpbWUpKQogICAgICAgICAgdGVtcC5nZXRfbG9vcF9ldmVudF90aW1lID0gZGF0YTEubG9vcF9ldmVudF90aW1lCiAgICAgICAgICB0ZW1wLmdldF9sb2NhdGlvbiA9IGRhdGExLmxvY2F0aW9uCiAgICAgICAgICB0ZW1wLmdldF9scCA9IGRhdGExLmxwCiAgICAgICAgICB0ZW1wLmdldF9yZWdpc3RlcmVkID0gZGF0YTEucmVnaXN0ZXJlZAogICAgICAgICAgdGVtcC5nZXRfZGlyZWN0aW9uID0gZGF0YTEuZGlyZWN0aW9uMQogICAgICAgICAgdGVtcC5nZXRfY29udGVudHMgPSBkYXRhMS5jb250ZW50cwogICAgICAgICAgdGVtcC5nZXRfaW1hZ2VfZGlzcGxheSA9IHRydWUKICAgICAgICAgIHRlbXAuZ2V0X2ltYWdlX25hbWUgPSBpbWFnZV9uYW1lCiAgICAgICAgICBpZiAoZGF0YTEuZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgIHRlbXAuZ2V0X2Rpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICB0ZW1wLmdldF9wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgdGVtcC5nZXRfZmVlID0gMAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCFkYXRhMS5kaXNjb3VudGVkX2ZlZSkgewogICAgICAgICAgICAgIGRhdGExLmRpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YTEuZmVlKSB7CiAgICAgICAgICAgICAgZGF0YTEuZmVlID0gMAogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YTEucGFpZF9mZWUpIHsKICAgICAgICAgICAgICBkYXRhMS5wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgfQogICAgICAgICAgICB0ZW1wLmdldF9kaXNjb3VudGVkX2ZlZSA9IHBhcnNlSW50KGRhdGExLmRpc2NvdW50ZWRfZmVlLCAxMCkKICAgICAgICAgICAgdGVtcC5nZXRfcGFpZF9mZWUgPSBwYXJzZUludChkYXRhMS5wYWlkX2ZlZSwgMTApCiAgICAgICAgICAgIHRlbXAuZ2V0X2ZlZSA9IHBhcnNlSW50KGRhdGExLmZlZSwgMTApCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJmbGFnID09PSBmYWxzZSA6ICIsIGRhdGExKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kYXRhTGlzdC51bnNoaWZ0KHRlbXApCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vCWNvbnNvbGUubG9nKGRhdGExLmxwLCB0aGlzLmNhcm1lcmFfbGlzdFtpXS5sb2NhdGlvbiwgZGF0YTEubG9jYXRpb24pOwogICAgICAgICAgICBpZiAoZGF0YTEubG9jYXRpb24gPT09IHRoaXMuY2FybWVyYV9saXN0W2ldLmxvY2F0aW9uICYmIGRhdGExLmRpcmVjdGlvbiA9PT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0uZGlyZWN0aW9uKSB7CiAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3RbaV0ubHAgPSBkYXRhMS5scAogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLmltYWdlX25hbWUgPSBpbWFnZV9uYW1lCiAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnB1c2godGVtcCkKICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxldCB0b3RhbF9wYXJraW5nX2ZlZSA9IDAKICAgICAgICBsZXQgdG90YWxfZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgbGV0IHRvdGFsX3BhaWRfZmVlID0gMAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kYXRhTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgdG90YWxfcGFya2luZ19mZWUgKz0gcGFyc2VJbnQodGhpcy5kYXRhTGlzdFtpXS5nZXRfZmVlLCAxMCkKICAgICAgICAgIHRvdGFsX2Rpc2NvdW50ZWRfZmVlICs9IHBhcnNlSW50KAogICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9kaXNjb3VudGVkX2ZlZSwKICAgICAgICAgICAgMTAKICAgICAgICAgICkKICAgICAgICAgIHRvdGFsX3BhaWRfZmVlICs9IHBhcnNlSW50KHRoaXMuZGF0YUxpc3RbaV0uZ2V0X3BhaWRfZmVlLCAxMCkKICAgICAgICB9CiAgICAgICAgdGhpcy50b3RhbF9wYXJraW5nX2ZlZSA9IHRvdGFsX3BhcmtpbmdfZmVlCiAgICAgICAgdGhpcy50b3RhbF9kaXNjb3VudGVkX2ZlZSA9IHRvdGFsX2Rpc2NvdW50ZWRfZmVlCiAgICAgICAgdGhpcy50b3RhbF9wYWlkX2ZlZSA9IHRvdGFsX3BhaWRfZmVlCiAgICAgICAgLy8JY29uc29sZS5sb2codGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoKTsKICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09ICJmZWVfY2FsY3VsYXRpb25fcmVzdWx0IikgewogICAgICAgIGNvbnNvbGUubG9nKGRhdGExLmtpbmQsIGRhdGExKQogICAgICAgIC8vdmFyIGltYWdlX25hbWUgPSAibG9jYWxob3N0OjcyMDAvaW1hZ2VzLyIrZGF0YTEuZm9sZGVyX25hbWUrIi8iK2RhdGExLmZpbGVuYW1lCiAgICAgICAgbGV0IGltYWdlX25hbWUgPQogICAgICAgICAgY29uZmlnLmltYWdlX3NyYyArIGRhdGExLmZvbGRlcl9uYW1lICsgIi8iICsgZGF0YTEuZmlsZW5hbWUKICAgICAgICAvLyBjb25zb2xlLmxvZygiaW1hZ2VfbmFtZSA6ICIsIGltYWdlX25hbWUpCiAgICAgICAgLy8JY29uc29sZS5sb2coImRhdGFMaXN0IDogIiwgdGhpcy5kYXRhTGlzdCk7CiAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgZGF0YTEuZGlyZWN0aW9uMSA9ICLsnoXssKgiCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRhdGExLmRpcmVjdGlvbjEgPSAi7Lac7LCoIgogICAgICAgIH0KICAgICAgICBsZXQgZmxhZyA9IGZhbHNlCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGFMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xvb3BfZXZlbnRfdGltZSwgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHApOwogICAgICAgICAgaWYgKHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xvb3BfZXZlbnRfdGltZSA9PT0gZGF0YTEubG9vcF9ldmVudF90aW1lKSB7CiAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xwID0gZGF0YTEubHAKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcmVnaXN0ZXJlZCA9IGRhdGExLnJlZ2lzdGVyZWQKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlyZWN0aW9uID0gZGF0YTEuZGlyZWN0aW9uCiAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2NvbnRlbnRzID0gZGF0YTEuY29udGVudHMKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfaW1hZ2VfbmFtZSA9IHRydWUKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfaW1hZ2VfbmFtZSA9IGltYWdlX25hbWUKICAgICAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2Rpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X3BhaWRfZmVlID0gMAogICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ZlZSA9IDAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoIWRhdGExLmRpc2NvdW50ZWRfZmVlKSB7CiAgICAgICAgICAgICAgICBkYXRhMS5kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCFkYXRhMS5mZWUgfHwgZGF0YTEuZmVlID09PSA5OTk4IHx8IGRhdGExLmZlZSA9PT0gOTk5OSkgewogICAgICAgICAgICAgICAgZGF0YTEuZmVlID0gMAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIWRhdGExLnBhaWRfZmVlKSB7CiAgICAgICAgICAgICAgICBkYXRhMS5wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlzY291bnRlZF9mZWUgPSBwYXJzZUludCgKICAgICAgICAgICAgICAgIGRhdGExLmRpc2NvdW50ZWRfZmVlLAogICAgICAgICAgICAgICAgMTAKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUgPSBwYXJzZUludChkYXRhMS5wYWlkX2ZlZSwgMTApCiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZmVlID0gcGFyc2VJbnQoZGF0YTEuZmVlLCAxMCkKICAgICAgICAgICAgfQogICAgICAgICAgICBmbGFnID0gdHJ1ZQogICAgICAgICAgICBicmVhawogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZmxhZyA9PSBmYWxzZSkgewogICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgdGVtcC5nZXRfdGltZSA9IGZvcm1hdF90aW1lKG5ldyBEYXRlKGRhdGExLmxvb3BfZXZlbnRfdGltZSkpCiAgICAgICAgICB0ZW1wLmdldF9sb29wX2V2ZW50X3RpbWUgPSBkYXRhMS5sb29wX2V2ZW50X3RpbWUKICAgICAgICAgIHRlbXAuZ2V0X2xvY2F0aW9uID0gZGF0YTEubG9jYXRpb24KICAgICAgICAgIHRlbXAuZ2V0X2xwID0gZGF0YTEubHAKICAgICAgICAgIHRlbXAuZ2V0X3JlZ2lzdGVyZWQgPSBkYXRhMS5yZWdpc3RlcmVkCiAgICAgICAgICB0ZW1wLmdldF9kaXJlY3Rpb24gPSBkYXRhMS5kaXJlY3Rpb24KICAgICAgICAgIHRlbXAuZ2V0X2NvbnRlbnRzID0gZGF0YTEuY29udGVudHMKICAgICAgICAgIHRlbXAuZ2V0X2ltYWdlX2Rpc3BsYXkgPSB0cnVlCiAgICAgICAgICB0ZW1wLmdldF9pbWFnZV9uYW1lID0gaW1hZ2VfbmFtZQogICAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgICB0ZW1wLmdldF9kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgICAgdGVtcC5nZXRfcGFpZF9mZWUgPSAwCiAgICAgICAgICAgIHRlbXAuZ2V0X2ZlZSA9IDAKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICghZGF0YTEuZGlzY291bnRlZF9mZWUpIHsKICAgICAgICAgICAgICBkYXRhMS5kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWRhdGExLmZlZSB8fCBkYXRhMS5mZWUgPT09IDk5OTggfHwgZGF0YTEuZmVlID09PSA5OTk5KSB7CiAgICAgICAgICAgICAgZGF0YTEuZmVlID0gMAogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YTEucGFpZF9mZWUpIHsKICAgICAgICAgICAgICBkYXRhMS5wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgfQogICAgICAgICAgICB0ZW1wLmdldF9kaXNjb3VudGVkX2ZlZSA9IGRhdGExLmRpc2NvdW50ZWRfZmVlCiAgICAgICAgICAgIHRlbXAuZ2V0X3BhaWRfZmVlID0gZGF0YTEucGFpZF9mZWUKICAgICAgICAgICAgdGVtcC5nZXRfZmVlID0gZGF0YTEuZmVlCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmRhdGFMaXN0LnVuc2hpZnQodGVtcCkKICAgICAgICB9CiAgICAgICAgbGV0IHRvdGFsX3BhcmtpbmdfZmVlID0gMAogICAgICAgIGxldCB0b3RhbF9kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICBsZXQgdG90YWxfcGFpZF9mZWUgPSAwCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGFMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0b3RhbF9wYXJraW5nX2ZlZSArPSBwYXJzZUludCh0aGlzLmRhdGFMaXN0W2ldLmdldF9mZWUsIDEwKQogICAgICAgICAgdG90YWxfZGlzY291bnRlZF9mZWUgKz0gcGFyc2VJbnQoCiAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2Rpc2NvdW50ZWRfZmVlLAogICAgICAgICAgICAxMAogICAgICAgICAgKQogICAgICAgICAgdG90YWxfcGFpZF9mZWUgKz0gcGFyc2VJbnQodGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUsIDEwKQogICAgICAgIH0KICAgICAgICB0aGlzLnRvdGFsX3BhcmtpbmdfZmVlID0gdG90YWxfcGFya2luZ19mZWUKICAgICAgICB0aGlzLnRvdGFsX2Rpc2NvdW50ZWRfZmVlID0gdG90YWxfZGlzY291bnRlZF9mZWUKICAgICAgICB0aGlzLnRvdGFsX3BhaWRfZmVlID0gdG90YWxfcGFpZF9mZWUKICAgICAgICAvLwljb25zb2xlLmxvZyh0aGlzLmNhcm1lcmFfbGlzdC5sZW5ndGgpOwogICAgICB9IGVsc2UgaWYgKGRhdGExLmtpbmQgPT0gImxwcl9wYXltZW50IikgewogICAgICAgICAgY29uc29sZS5sb2coZGF0YTEua2luZCwgZGF0YTEpCiAgICAgICAgLy92YXIgaW1hZ2VfbmFtZSA9ICJsb2NhbGhvc3Q6NzIwMC9pbWFnZXMvIitkYXRhMS5mb2xkZXJfbmFtZSsiLyIrZGF0YTEuZmlsZW5hbWUKICAgICAgICBsZXQgaW1hZ2VfbmFtZSA9CiAgICAgICAgICBjb25maWcuaW1hZ2Vfc3JjICsgZGF0YTEuZm9sZGVyX25hbWUgKyAiLyIgKyBkYXRhMS5maWxlbmFtZQogICAgICAgIC8vICBjb25zb2xlLmxvZygiaW1hZ2VfbmFtZSA6ICIsIGltYWdlX25hbWUpCiAgICAgICAgLy8JY29uc29sZS5sb2coImRhdGFMaXN0IDogIiwgdGhpcy5kYXRhTGlzdCk7CiAgICAgICAgaWYgKGRhdGExLmRpcmVjdGlvbiA9PT0gImluIikgewogICAgICAgICAgZGF0YTEuZGlyZWN0aW9uMSA9ICJpbiIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YTEuZGlyZWN0aW9uMSA9ICJvdXQiCiAgICAgICAgfQogICAgICAgIGxldCBmbGFnID0gZmFsc2UKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF0YUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5kYXRhTGlzdFtpXS5nZXRfbG9vcF9ldmVudF90aW1lLCB0aGlzLmRhdGFMaXN0W2ldLmdldF9scCk7CiAgICAgICAgICBpZiAodGhpcy5kYXRhTGlzdFtpXS5nZXRfbG9vcF9ldmVudF90aW1lID09PSBkYXRhMS5sb29wX2V2ZW50X3RpbWUpIHsKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHAgPSBkYXRhMS5scAogICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9yZWdpc3RlcmVkID0gZGF0YTEucmVnaXN0ZXJlZAogICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9kaXJlY3Rpb24gPSBkYXRhMS5kaXJlY3Rpb24KICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfY29udGVudHMgPSBkYXRhMS5jb250ZW50cwogICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9pbWFnZV9uYW1lID0gdHJ1ZQogICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9pbWFnZV9uYW1lID0gaW1hZ2VfbmFtZQogICAgICAgICAgICBpZiAoZGF0YTEuZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUgPSAwCiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZmVlID0gMAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmICghZGF0YTEuZGlzY291bnRlZF9mZWUpIHsKICAgICAgICAgICAgICAgIGRhdGExLmRpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIWRhdGExLmZlZSB8fCBkYXRhMS5mZWUgPT09IDk5OTggfHwgZGF0YTEuZmVlID09PSA5OTk5KSB7CiAgICAgICAgICAgICAgICBkYXRhMS5mZWUgPSAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghZGF0YTEucGFpZF9mZWUpIHsKICAgICAgICAgICAgICAgIGRhdGExLnBhaWRfZmVlID0gMAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9kaXNjb3VudGVkX2ZlZSA9IGRhdGExLmRpc2NvdW50ZWRfZmVlCiAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUgPSBkYXRhMS5wYWlkX2ZlZQogICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ZlZSA9IGRhdGExLmZlZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZsYWcgPSB0cnVlCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChmbGFnID09IGZhbHNlKSB7CiAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICB0ZW1wLmdldF90aW1lID0gZm9ybWF0X3RpbWUobmV3IERhdGUoZGF0YTEubG9vcF9ldmVudF90aW1lKSkKICAgICAgICAgIHRlbXAuZ2V0X2xvb3BfZXZlbnRfdGltZSA9IGRhdGExLmxvb3BfZXZlbnRfdGltZQogICAgICAgICAgdGVtcC5nZXRfbG9jYXRpb24gPSBkYXRhMS5sb2NhdGlvbgogICAgICAgICAgdGVtcC5nZXRfbHAgPSBkYXRhMS5scAogICAgICAgICAgdGVtcC5nZXRfcmVnaXN0ZXJlZCA9IGRhdGExLnJlZ2lzdGVyZWQKICAgICAgICAgIHRlbXAuZ2V0X2RpcmVjdGlvbiA9IGRhdGExLmRpcmVjdGlvbgogICAgICAgICAgdGVtcC5nZXRfY29udGVudHMgPSBkYXRhMS5jb250ZW50cwogICAgICAgICAgdGVtcC5nZXRfaW1hZ2VfZGlzcGxheSA9IHRydWUKICAgICAgICAgIHRlbXAuZ2V0X2ltYWdlX25hbWUgPSBpbWFnZV9uYW1lCiAgICAgICAgICBpZiAoZGF0YTEuZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgIHRlbXAuZ2V0X2Rpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICB0ZW1wLmdldF9wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgdGVtcC5nZXRfZmVlID0gMAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCFkYXRhMS5kaXNjb3VudGVkX2ZlZSkgewogICAgICAgICAgICAgIGRhdGExLmRpc2NvdW50ZWRfZmVlID0gMAogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YTEuZmVlIHx8IGRhdGExLmZlZSA9PT0gOTk5OCB8fCBkYXRhMS5mZWUgPT09IDk5OTkpIHsKICAgICAgICAgICAgICBkYXRhMS5mZWUgPSAwCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFkYXRhMS5wYWlkX2ZlZSkgewogICAgICAgICAgICAgIGRhdGExLnBhaWRfZmVlID0gMAogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXAuZ2V0X2Rpc2NvdW50ZWRfZmVlID0gZGF0YTEuZGlzY291bnRlZF9mZWUKICAgICAgICAgICAgdGVtcC5nZXRfcGFpZF9mZWUgPSBkYXRhMS5wYWlkX2ZlZQogICAgICAgICAgICB0ZW1wLmdldF9mZWUgPSBkYXRhMS5mZWUKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZGF0YUxpc3QudW5zaGlmdCh0ZW1wKQogICAgICAgIH0KICAgICAgICBsZXQgdG90YWxfcGFya2luZ19mZWUgPSAwCiAgICAgICAgbGV0IHRvdGFsX2Rpc2NvdW50ZWRfZmVlID0gMAogICAgICAgIGxldCB0b3RhbF9wYWlkX2ZlZSA9IDAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF0YUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRvdGFsX3BhcmtpbmdfZmVlICs9IHBhcnNlSW50KHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ZlZSwgMTApCiAgICAgICAgICB0b3RhbF9kaXNjb3VudGVkX2ZlZSArPSBwYXJzZUludCgKICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlzY291bnRlZF9mZWUsCiAgICAgICAgICAgIDEwCiAgICAgICAgICApCiAgICAgICAgICB0b3RhbF9wYWlkX2ZlZSArPSBwYXJzZUludCh0aGlzLmRhdGFMaXN0W2ldLmdldF9wYWlkX2ZlZSwgMTApCiAgICAgICAgfQogICAgICAgIHRoaXMudG90YWxfcGFya2luZ19mZWUgPSB0b3RhbF9wYXJraW5nX2ZlZQogICAgICAgIHRoaXMudG90YWxfZGlzY291bnRlZF9mZWUgPSB0b3RhbF9kaXNjb3VudGVkX2ZlZQogICAgICAgIHRoaXMudG90YWxfcGFpZF9mZWUgPSB0b3RhbF9wYWlkX2ZlZQogICAgICAgIC8vCWNvbnNvbGUubG9nKHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCk7CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgZGF0YTEua2luZCA9PT0gImJhcnJpZXJfcG9saWN5X3F1ZXJ5IiB8fAogICAgICAgIGRhdGExLmtpbmQgPT09ICJnZXRfYmFycmllcl9wb2xpY3lfcXVlcnkiCiAgICAgICkgewogICAgICAgIGNvbnNvbGUubG9nKCJkYXRhMV9iYXJyaWVyX3BvbGljeV9xdWVyeSA6ICIsIGRhdGExKQogICAgICAgIC8vY29uc29sZS5sb2coImRhdGExX2RvY3NbMF0gOiAiLCBkYXRhMS5kb2NzWzBdLCBkYXRhMS5kb2NzWzFdLCBkYXRhMS5kb2NzLmxlbmd0aCwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoKTsKICAgICAgICBpZiAoCiAgICAgICAgICBkYXRhMS5kb2NzICYmCiAgICAgICAgICBkYXRhMS5kb2NzLmxlbmd0aCA+IDAgJiYKICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCA+IDAKICAgICAgICApIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YTEuZG9jcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBsZXQgZGlyZWN0aW9uID0gIm91dCIKICAgICAgICAgICAgaWYgKGRhdGExLmRvY3NbaV0uZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgICAgZGlyZWN0aW9uID0gImluIgogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJiYXJyaWVyX3BvbGljeV9xdWVyeSBvYmogOiAiLCBkYXRhMS5kb2NzW2ldLmxvY2F0aW9uLCB0aGlzLmNhcm1lcmFfbGlzdFswXS5sb2NhdGlvbiwgdGhpcy5jYXJtZXJhX2xpc3RbMV0ubG9jYXRpb24pCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtqXS5sb2NhdGlvbiA9PT0gZGF0YTEuZG9jc1tpXS5sb2NhdGlvbiAmJgogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3Rbal0uZGlyZWN0aW9uID09PSBkaXJlY3Rpb24KICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2pdLmNoZWNrZWROYW1lcyA9IGRhdGExLmRvY3NbaV0udmFsdWUKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coICJkYXRhMV9iYXJyaWVyX3BvbGljeV9xdWVyeSA6ICIsIHRoaXMuY2FybWVyYV9saXN0W2pdKQogICAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3QucHVzaCh0ZW1wKQogICAgICAgICAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3Quc3BsaWNlKHRoaXMuY2FybWVyYV9saXN0Lmxlbmd0aCAtIDEsIDEpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhMS5raW5kID09PSAiZ2V0X3ZlaGljbGVfb2JqX2xpc3QiKSB7CiAgICAgICAgLy8gICBjb25zb2xlLmxvZygiZ2V0X3ZlaGljbGVfb2JqX2xpc3QgOiAiLCBkYXRhMSkKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGExLmRvY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGxldCBvYmogPSBkYXRhMS5kb2NzW2ldCiAgICAgICAgICBsZXQgaW1hZ2VfbmFtZSA9CiAgICAgICAgICAgIGNvbmZpZy5pbWFnZV9zcmMgKyBvYmouZm9sZGVyX25hbWUgKyAiLyIgKyBvYmouZmlsZW5hbWUKICAgICAgICAgIC8vICBjb25zb2xlLmxvZygiaW1hZ2VfbmFtZSA6ICIsIGltYWdlX25hbWUpCiAgICAgICAgICAvLwljb25zb2xlLmxvZygiZGF0YUxpc3QgOiAiLCB0aGlzLmRhdGFMaXN0KTsKICAgICAgICAgIGlmIChvYmouZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgIG9iai5kaXJlY3Rpb24xID0gIuyeheywqCIKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9iai5kaXJlY3Rpb24xID0gIuy2nOywqCIKICAgICAgICAgIH0KICAgICAgICAgIGxldCBmbGFnID0gZmFsc2UKICAgICAgICAgIGxldCB0b3RhbF9wYXJraW5nX2ZlZSA9IDAKICAgICAgICAgIGxldCB0b3RhbF9kaXNjb3VudGVkX2ZlZSA9IDAKICAgICAgICAgIGxldCB0b3RhbF9wYWlkX2ZlZSA9IDAKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kYXRhTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xvb3BfZXZlbnRfdGltZSwgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHApOwogICAgICAgICAgICBpZiAodGhpcy5kYXRhTGlzdFtpXS5nZXRfbG9vcF9ldmVudF90aW1lID09PSBvYmoubG9vcF9ldmVudF90aW1lKSB7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgb2JqLmxwICE9ICLrr7jsnbjsi50iICYmCiAgICAgICAgICAgICAgICBvYmoubHAuaW5kZXhPZigiWCIpIDwgMCAmJgogICAgICAgICAgICAgICAgb2JqLmxwLmxlbmd0aCA+PSA3CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAvLyDrk6TslrTsmKgg7LCo65+J7J20IOuvuOyduOyLneydtCDslYTri4jrqbQKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHAgPT0gIuuvuOyduOyLnSIgfHwKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHAuaW5kZXhPZigiWCIpID49IDAgfHwKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfbHAubGVuZ3RoIDwgNwogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2xwID0gb2JqLmxwCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X3JlZ2lzdGVyZWQgPSBvYmoucmVnaXN0ZXJlZAogICAgICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9kaXJlY3Rpb24gPSBvYmouZGlyZWN0aW9uCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2NvbnRlbnRzID0gb2JqLmNvbnRlbnRzCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ltYWdlX25hbWUgPSB0cnVlCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ltYWdlX25hbWUgPSBpbWFnZV9uYW1lCiAgICAgICAgICAgICAgICAgIGlmIChvYmouZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfcGFpZF9mZWUgPSAwCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZmVlID0gMAogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICghb2JqLmRpc2NvdW50ZWRfZmVlKSB7CiAgICAgICAgICAgICAgICAgICAgICBvYmouZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghZGF0YTEuZmVlIHx8IG9iai5mZWUgPT09IDk5OTggfHwgb2JqLmZlZSA9PT0gOTk5OSkgewogICAgICAgICAgICAgICAgICAgICAgb2JqLmZlZSA9IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmoucGFpZF9mZWUpIHsKICAgICAgICAgICAgICAgICAgICAgIG9iai5wYWlkX2ZlZSA9IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhTGlzdFtpXS5nZXRfZGlzY291bnRlZF9mZWUgPSBvYmouZGlzY291bnRlZF9mZWUKICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFMaXN0W2ldLmdldF9wYWlkX2ZlZSA9IG9iai5wYWlkX2ZlZQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaV0uZ2V0X2ZlZSA9IG9iai5mZWUKICAgICAgICAgICAgICAgICAgICB0b3RhbF9wYXJraW5nX2ZlZSArPSBwYXJzZUludChvYmouZmVlLCAxMCkKICAgICAgICAgICAgICAgICAgICB0b3RhbF9kaXNjb3VudGVkX2ZlZSArPSBwYXJzZUludChvYmouZGlzY291bnRlZF9mZWUsIDEwKQogICAgICAgICAgICAgICAgICAgIHRvdGFsX3BhaWRfZmVlICs9IHBhcnNlSW50KG9iai5wYWlkX2ZlZSwgMTApCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZmxhZyA9IHRydWUKICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZmxhZyA9PSBmYWxzZSkgewogICAgICAgICAgICBsZXQgdGVtcCA9IHt9CiAgICAgICAgICAgIHRlbXAuZ2V0X3RpbWUgPSBmb3JtYXRfdGltZShuZXcgRGF0ZShvYmoubG9vcF9ldmVudF90aW1lKSkKICAgICAgICAgICAgdGVtcC5nZXRfbG9vcF9ldmVudF90aW1lID0gb2JqLmxvb3BfZXZlbnRfdGltZQogICAgICAgICAgICB0ZW1wLmdldF9sb2NhdGlvbiA9IG9iai5sb2NhdGlvbgogICAgICAgICAgICB0ZW1wLmdldF9scCA9IG9iai5scAogICAgICAgICAgICB0ZW1wLmdldF9yZWdpc3RlcmVkID0gb2JqLnJlZ2lzdGVyZWQKICAgICAgICAgICAgdGVtcC5nZXRfZGlyZWN0aW9uID0gb2JqLmRpcmVjdGlvbgogICAgICAgICAgICB0ZW1wLmdldF9jb250ZW50cyA9IG9iai5jb250ZW50cwogICAgICAgICAgICB0ZW1wLmdldF9pbWFnZV9kaXNwbGF5ID0gdHJ1ZQogICAgICAgICAgICB0ZW1wLmdldF9pbWFnZV9uYW1lID0gaW1hZ2VfbmFtZQogICAgICAgICAgICBpZiAoZGF0YTEuZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgICAgICAgdGVtcC5nZXRfZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgICAgICAgdGVtcC5nZXRfcGFpZF9mZWUgPSAwCiAgICAgICAgICAgICAgdGVtcC5nZXRfZmVlID0gMAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmICghb2JqLmRpc2NvdW50ZWRfZmVlKSB7CiAgICAgICAgICAgICAgICBvYmouZGlzY291bnRlZF9mZWUgPSAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghb2JqLmZlZSB8fCBvYmouZmVlID09PSA5OTk4IHx8IG9iai5mZWUgPT09IDk5OTkpIHsKICAgICAgICAgICAgICAgIG9iai5mZWUgPSAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghb2JqLnBhaWRfZmVlKSB7CiAgICAgICAgICAgICAgICBvYmoucGFpZF9mZWUgPSAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRlbXAuZ2V0X2Rpc2NvdW50ZWRfZmVlID0gb2JqLmRpc2NvdW50ZWRfZmVlCiAgICAgICAgICAgICAgdGVtcC5nZXRfcGFpZF9mZWUgPSBvYmoucGFpZF9mZWUKICAgICAgICAgICAgICB0ZW1wLmdldF9mZWUgPSBvYmouZmVlCiAgICAgICAgICAgICAgdG90YWxfcGFya2luZ19mZWUgKz0gcGFyc2VJbnQob2JqLmZlZSwgMTApCiAgICAgICAgICAgICAgdG90YWxfZGlzY291bnRlZF9mZWUgKz0gcGFyc2VJbnQob2JqLmRpc2NvdW50ZWRfZmVlLCAxMCkKICAgICAgICAgICAgICB0b3RhbF9wYWlkX2ZlZSArPSBwYXJzZUludChvYmoucGFpZF9mZWUsIDEwKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuZGF0YUxpc3QudW5zaGlmdCh0ZW1wKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy50b3RhbF9wYXJraW5nX2ZlZSArPSB0b3RhbF9wYXJraW5nX2ZlZQogICAgICAgICAgdGhpcy50b3RhbF9kaXNjb3VudGVkX2ZlZSArPSB0b3RhbF9kaXNjb3VudGVkX2ZlZQogICAgICAgICAgdGhpcy50b3RhbF9wYWlkX2ZlZSArPSB0b3RhbF9wYWlkX2ZlZQogICAgICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgICAgICAvLyAgICJ0b3RhbF9wYXJraW5nX2ZlZSA6IiwKICAgICAgICAgIC8vICAgdG90YWxfcGFya2luZ19mZWUsCiAgICAgICAgICAvLyAgICJ0b3RhbF9kaXNjb3VudGVkX2ZlZSA6IiwKICAgICAgICAgIC8vICAgdG90YWxfZGlzY291bnRlZF9mZWUsCiAgICAgICAgICAvLyAgICJ0b3RhbF9wYWlkX2ZlZTogIiwKICAgICAgICAgIC8vICAgdG90YWxfcGFpZF9mZWUKICAgICAgICAgIC8vICkKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgLy8JY29uc29sZS5sb2coZGF0YTEubHAsIHRoaXMuY2FybWVyYV9saXN0W2ldLmxvY2F0aW9uLCBkYXRhMS5sb2NhdGlvbik7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBvYmoubG9jYXRpb24gPT0gdGhpcy5jYXJtZXJhX2xpc3RbaV0ubG9jYXRpb24gJiYKICAgICAgICAgICAgICBvYmouZGlyZWN0aW9uID09IHRoaXMuY2FybWVyYV9saXN0W2ldLmRpcmVjdGlvbgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdFtpXS5scCA9IG9iai5scAogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0W2ldLmltYWdlX25hbWUgPSBpbWFnZV9uYW1lCiAgICAgICAgICAgICAgbGV0IHRlbXAgPSB7fQogICAgICAgICAgICAgIHRoaXMuY2FybWVyYV9saXN0LnB1c2godGVtcCkKICAgICAgICAgICAgICB0aGlzLmNhcm1lcmFfbGlzdC5zcGxpY2UodGhpcy5jYXJtZXJhX2xpc3QubGVuZ3RoIC0gMSwgMSkKICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY29udGVudHNfY2hhbmdlKGluZGV4KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCLrgrTsmqnrs4Dqsr0gOiIsIHRoaXMuZGF0YUxpc3RbaW5kZXhdKQogICAgICB2YXIgb2JqID0ge30KICAgICAgLy8gb2JqLmtpbmQgPSAidXBkYXRlX3ZlaGljbGVfb2JqX2F0X3ZlaGljbGVfb2JqX2xpc3QiCiAgICAgIG9iai5raW5kMSA9ICJ1cGRhdGVfdmVoaWNsZV9vYmpfYXRfdmVoaWNsZV9vYmpfbGlzdCIKICAgICAgb2JqLmxwID0gdGhpcy5kYXRhTGlzdFtpbmRleF0uZ2V0X2xwCiAgICAgIG9iai5sb29wX2V2ZW50X3RpbWUgPSB0aGlzLmRhdGFMaXN0W2luZGV4XS5nZXRfbG9vcF9ldmVudF90aW1lCiAgICAgIG9iai5jb250ZW50cyA9IHRoaXMuZGF0YUxpc3RbaW5kZXhdLmdldF9jb250ZW50cwogICAgICBvYmoubnVtYmVyID0gb2JqLmxwLnJlcGxhY2UoL1vqsIAt7Z6dXS9naSwgIiIpCiAgICAgIHRoaXMuc2VuZE1lc3NhZ2Uob2JqKQogICAgfSwKICAgIHZlaGljbGVfb2JqX2xpc3RfZmluZCgpIHsKICAgICAgbGV0IGQgPSBuZXcgRGF0ZSgpCiAgICAgIC8vbGV0IGQxID0gZCAtICgyNCo2MCo2MCoxMDAwKTsKICAgICAgLy9jb25zb2xlLmxvZygiZCA6ICIsIGQsICIgZDEgOiAiLCBkMSk7CiAgICAgIGxldCBzdHJfc3RhcnQgPQogICAgICAgIGQuZ2V0RnVsbFllYXIoKSArCiAgICAgICAgIi0iICsKICAgICAgICBpdG9TdHIoZC5nZXRNb250aCgpICsgMSkgKwogICAgICAgICItIiArCiAgICAgICAgaXRvU3RyKGQuZ2V0RGF0ZSgpKSArCiAgICAgICAgIlQwMDowMCIKICAgICAgbGV0IHN0cl9lbmQgPQogICAgICAgIGQuZ2V0RnVsbFllYXIoKSArCiAgICAgICAgIi0iICsKICAgICAgICBpdG9TdHIoZC5nZXRNb250aCgpICsgMSkgKwogICAgICAgICItIiArCiAgICAgICAgaXRvU3RyKGQuZ2V0RGF0ZSgpKSArCiAgICAgICAgIlQyMzo1OSIKICAgICAgdGhpcy5zdGFydF90aW1lID0gc3RyX3N0YXJ0CiAgICAgIHRoaXMuZW5kX3RpbWUgPSBzdHJfZW5kCiAgICAgIGxldCBvYmogPSB7fQogICAgICBvYmouc3RhcnRfdGltZSA9IGdldF9zdGFydF90aW1lKHRoaXMuc3RhcnRfdGltZSkKICAgICAgb2JqLmVuZF90aW1lID0gZ2V0X2VuZF90aW1lKHRoaXMuZW5kX3RpbWUpCiAgICAgIG9iai5raW5kID0gImdldF92ZWhpY2xlX29ial9saXN0IgogICAgICBvYmouaWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oImFkbWluX2lkIikKICAgICAgb2JqLnB3ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhZG1pbl9wdyIpCiAgICAgIC8vIGNvbnNvbGUubG9nKCJscF9zZWFyY2goKSA6ICIsIG9iaikKICAgICAgdGhpcy5zZW5kTWVzc2FnZShvYmopCiAgICB9LAogICAgc2lnbmFsKGMpIHsKICAgICAgYy5pbWFnZV9kaXNwbGF5ID0gIWMuaW1hZ2VfZGlzcGxheQogICAgfSwKICAgIHRvZ2dsZXMoKSB7CiAgICAgIHRoaXMudG9nZ2xlID0gIXRoaXMudG9nZ2xlCiAgICAgIC8vICBjb25zb2xlLmxvZyh0aGlzLnRvZ2dsZSkKICAgIH0sCiAgICBvcGVuX3BpY3R1cmUoZCkgeyAgICAgIAogICAgICAvLyBkLmdldF9pbWFnZV9kaXNwbGF5ID0gZmFsc2UKICAgICAgZC5nZXRfaW1hZ2VfZGlzcGxheSA9ICFkLmdldF9pbWFnZV9kaXNwbGF5CiAgICAgCiAgICB9LAogICAgY2xvc2VfcGljdHVyZShkKSB7CiAgICAgIC8vICBjb25zb2xlLmxvZygiY2xvc2VfcGljdHVyZSA6ICIsIGQuZ2V0X2ltYWdlX2Rpc3BsYXkpCiAgICAgIC8vdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24oKXsKICAgICAgcmV0dXJuIChkLmdldF9pbWFnZV9kaXNwbGF5ID0gdHJ1ZSkKICAgICAgLy99KQogICAgfSwKICAgIGJhcl9jb250cm9sKGMpIHsKICAgICAgbGV0IG9iaiA9IHt9CiAgICAgIG9iai5raW5kID0gImNvbnRyb2wiCiAgICAgIG9iai5kaXJlY3Rpb24gPSAidXAiCiAgICAgIG9iai5sb2NhdGlvbiA9IGMubG9jYXRpb24KICAgICAgLy9pbmRleCA9IGMuaW5kZXgKICAgICAgLy9hZG1pbl9pZDogImFkbWluMDAxIgogICAgICB0aGlzLnNlbmRNZXNzYWdlKG9iaikKICAgIH0sCiAgICBiYXJfY29udHJvbF9jbG9zZShjKSB7CiAgICAgIGxldCBvYmogPSB7fQogICAgICBvYmoua2luZCA9ICIiCiAgICAgIG9iai5kaXJlY3Rpb24gPSAiIgogICAgICBvYmoubG9jYXRpb24gPSBjLmxvY2F0aW9uCiAgICAgIC8vaW5kZXggPSBjLmluZGV4CiAgICAgIC8vYWRtaW5faWQ6ICJhZG1pbjAwMSIKICAgICAgdGhpcy5zZW5kTWVzc2FnZShvYmopCiAgICB9LAogICAgYmFyX21vZGVfbG9jayhjKSB7CiAgICAgIGxldCBvYmogPSB7fQogICAgICBvYmoua2luZCA9ICJtb2RlIgogICAgICBvYmoubW9kZSA9ICJsb2NrIgogICAgICBvYmoubG9jYXRpb24gPSBjLmxvY2F0aW9uCiAgICAgIC8vaW5kZXggPSBjLmluZGV4CiAgICAgIC8vYWRtaW5faWQ6ICJhZG1pbjAwMSIKICAgICAgdGhpcy5zZW5kTWVzc2FnZShvYmopCiAgICB9LAogICAgYmFyX21vZGVfdW5sb2NrKGMpIHsKICAgICAgbGV0IG9iaiA9IHt9CiAgICAgIG9iai5raW5kID0gIm1vZGUiCiAgICAgIG9iai5tb2RlID0gInVubG9jayIKICAgICAgb2JqLmxvY2F0aW9uID0gYy5sb2NhdGlvbgogICAgICAvL2luZGV4ID0gYy5pbmRleAogICAgICAvL2FkbWluX2lkOiAiYWRtaW4wMDEiCiAgICAgIHRoaXMuc2VuZE1lc3NhZ2Uob2JqKQogICAgfSwKCiAgICBiYXJfcG9saWN5X2Z1bihjKSB7CiAgICAgIGxldCBvYmogPSB7fQogICAgICBsZXQgZGlyZWN0aW9uID0gIm91dCIKICAgICAgaWYgKGMuZGlyZWN0aW9uID09PSAiaW4iKSB7CiAgICAgICAgZGlyZWN0aW9uID0gImluIgogICAgICB9CiAgICAgIG9iai5jbWQgPSAidXBkYXRlX2JhcnJpZXJfcG9saWN5IgogICAgICBvYmoua2luZCA9ICJiYXJyaWVyX3BvbGljeSIKICAgICAgb2JqLmxvY2F0aW9uID0gYy5sb2NhdGlvbgogICAgICBvYmouZGlyZWN0aW9uID0gZGlyZWN0aW9uCiAgICAgIG9iai52YWx1ZSA9IGMuY2hlY2tlZE5hbWVzCiAgICAgIG9iai50aW1lID0gRGF0ZS5ub3coKQogICAgICAvL2FkbWluX2lkOiAiYWRtaW4wMDEiCiAgICAgIC8vIGNvbnNvbGUubG9nKCJiYXJfcG9saWN5X2Z1biA6ICIsIG9iaikKICAgICAgdGhpcy5zZW5kTWVzc2FnZShvYmopCiAgICB9LAogICAgYmFycmllcl9uYW1lX2NoZWNrKCkgewogICAgICB0aGlzLmNhcm1lcmFfbGlzdCA9IFtdCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29uZmlnLmJhcnJpZXJfZGlzcGxheV9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5jYXJtZXJhX2xpc3QucHVzaChjb25maWcuYmFycmllcl9kaXNwbGF5X2xpc3RbaV0pCiAgICAgIH0KICAgICAgLy8gdGhpcy5iYXJfcG9saWN5X2Z1bl9hbGwoKQogICAgfSwKICAgIHNlbmRNZXNzYWdlKGMpIHsKICAgICAgdGhpcy4kc29ja2V0LmVtaXQoIm1lc3NhZ2VfZnJvbV93ZWJfY2xpZW50IiwgYykKICAgIH0sCiAgICBzdGFydCgpIHsKICAgICAgLy9jb25zb2xlLmxvZygic3RhcnQg7ZWo7IiYIOyLnOyekSAiKTsKICAgICAgbGV0IHRoYXQgPSB0aGlzCiAgICAgIGxldCBmbGFnID0gZmFsc2UKICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGxldCBkYXRlID0gRGF0ZS5ub3coKQogICAgICAgIGxldCB0ZW1wX2RhdGUgPSBmb3JtYXRfdGltZV9kYXRlKG5ldyBEYXRlKGRhdGUpKS5zcGxpdCgiOiIpCiAgICAgICAgbGV0IHRlbXBfaGggPSBwYXJzZUludCh0ZW1wX2RhdGVbMF0sIDEwKQogICAgICAgIGxldCB0ZW1wX21tID0gcGFyc2VJbnQodGVtcF9kYXRlWzFdLCAxMCkKICAgICAgICBpZiAoZmxhZyA9PT0gZmFsc2UgJiYgdGVtcF9oaCA9PT0gMCAmJiB0ZW1wX21tID09PSAwKSB7CiAgICAgICAgICB0aGF0LmRhdGFMaXN0ID0gW10KICAgICAgICAgIGZsYWcgPSB0cnVlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZsYWcgPSBmYWxzZQogICAgICAgIH0KICAgICAgfSwyMCAqIDEwMDApCiAgICAgIHRoaXMuYmFyX3N0YXR1c19xdWVyeSgpCiAgICAgIHRoaXMuYmFycmllcl9wb2xpY3lfcXVlcnkoKQogICAgfSwKICAgIGJhcl9zdGF0dXNfcXVlcnkoKSB7CiAgICAgIHZhciBvYmogPSB7fQogICAgICBvYmoua2luZCA9ICJiYXJfc3RhdHVzIgogICAgICBvYmouY29udHJvbF9pZCA9ICJhZG1pbjAwMSIKICAgICAgY29uc29sZS5sb2coImJhcl9zdGF0dXNfcXVlcnkiKQogICAgICB0aGlzLnNlbmRNZXNzYWdlKG9iaikKICAgIH0sCiAgICBiYXJyaWVyX3BvbGljeV9xdWVyeSgpIHsKICAgICAgdmFyIG9iaiA9IHt9CiAgICAgIG9iai5raW5kID0gImdldF9iYXJyaWVyX3BvbGljeV9xdWVyeSIKICAgICAgb2JqLmNvbnRyb2xfaWQgPSAiYWRtaW4wMDEiCiAgICAgIGNvbnNvbGUubG9nKCJiYXJyaWVyX3BvbGljeV9xdWVyeSIpCiAgICAgIC8vIGNvbnNvbGUubG9nKCJiYXJyaWVyX3BvbGljeV9xdWVyeSA6Iiwgb2JqKQogICAgICB0aGlzLnNlbmRNZXNzYWdlKG9iaikKICAgIH0KICB9Cn0KZnVuY3Rpb24gZ2V0X3N0YXJ0X3RpbWUoc3RyKSB7CiAgdmFyIHJlcyA9IHN0ci5zcGxpdCgvWy1ULjpcc10rLykKICB2YXIgZCA9IG5ldyBEYXRlKAogICAgcGFyc2VJbnQocmVzWzBdKSwKICAgIHBhcnNlSW50KHJlc1sxXSkgLSAxLAogICAgcGFyc2VJbnQocmVzWzJdKSwKICAgIHBhcnNlSW50KHJlc1szXSksCiAgICBwYXJzZUludChyZXNbNF0pLAogICAgMCwKICAgIDAKICApCiAgcmV0dXJuIGQuZ2V0VGltZSgpCn0KCmZ1bmN0aW9uIGdldF9lbmRfdGltZShzdHIpIHsKICB2YXIgcmVzID0gc3RyLnNwbGl0KC9bLVQuOlxzXSsvKQogIHZhciBkID0gbmV3IERhdGUoCiAgICBwYXJzZUludChyZXNbMF0pLAogICAgcGFyc2VJbnQocmVzWzFdKSAtIDEsCiAgICBwYXJzZUludChyZXNbMl0pLAogICAgcGFyc2VJbnQocmVzWzNdKSwKICAgIHBhcnNlSW50KHJlc1s0XSksCiAgICA1OSwKICAgIDk5OQogICkKICByZXR1cm4gZC5nZXRUaW1lKCkKfQovLyBmdW5jdGlvbiBmb3JtYXRfdGltZV9kYXRlKGRhdCkgewovLyAgIHZhciBzdHIgPSAiIgovLyAgIHN0ciArPSBudW1fdG9fc3RyKGRhdC5nZXRIb3VycygpKQovLyAgIHN0ciArPSAiOiIgKyBudW1fdG9fc3RyKGRhdC5nZXRNaW51dGVzKCkpCi8vICAgc3RyICs9ICI6IiArIG51bV90b19zdHIoZGF0LmdldFNlY29uZHMoKSkKLy8gICByZXR1cm4gc3RyCi8vIH0KCmZ1bmN0aW9uIG51bV90b19zdHIoJG51bSkgewogICRudW0gPCAxMCA/ICgkbnVtID0gIjAiICsgJG51bSkgOiAkbnVtCiAgcmV0dXJuICRudW0udG9TdHJpbmcoKQp9CmZ1bmN0aW9uIGZvcm1hdF90aW1lX2RhdGUoZGF0KSB7CiAgdmFyIHN0ciA9ICIiCiAgc3RyICs9IG51bV90b19zdHIoZGF0LmdldEhvdXJzKCkpCiAgc3RyICs9ICI6IiArIG51bV90b19zdHIoZGF0LmdldE1pbnV0ZXMoKSkKICBzdHIgKz0gIjoiICsgbnVtX3RvX3N0cihkYXQuZ2V0U2Vjb25kcygpKQogIHJldHVybiBzdHIKfQpmdW5jdGlvbiBpdG9TdHIoJG51bSkgewogICRudW0gPCAxMCA/ICgkbnVtID0gIjAiICsgJG51bSkgOiAkbnVtCiAgcmV0dXJuICRudW0udG9TdHJpbmcoKQp9CmZ1bmN0aW9uIGZvcm1hdF90aW1lKGRhdCkgewogIHZhciBzdHIgPSAiIgogIHN0ciArPSBkYXQuZ2V0RnVsbFllYXIoKQogIHN0ciArPSAiLiIgKyBudW1fdG9fc3RyKGRhdC5nZXRNb250aCgpICsgMSkKICBzdHIgKz0gIi4iICsgbnVtX3RvX3N0cihkYXQuZ2V0RGF0ZSgpKQogIHN0ciArPSAiLiAiICsgbnVtX3RvX3N0cihkYXQuZ2V0SG91cnMoKSkKICBzdHIgKz0gIjoiICsgbnVtX3RvX3N0cihkYXQuZ2V0TWludXRlcygpKQogIHN0ciArPSAiOiIgKyBudW1fdG9fc3RyKGRhdC5nZXRTZWNvbmRzKCkpCiAgcmV0dXJuIHN0cgp9Cg=="},{"version":3,"sources":["vehicleEntryExitLive.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"vehicleEntryExitLive.vue","sourceRoot":"src/components/operatingFunc","sourcesContent":["<template>\n <div class=\"vehicle_wrap\">\n   <div class=\"title\">\n      <h2>{{mainTitle[1].subMenu[0].title}}</h2>\n    </div>\n   <div class=\"present_condition_view\">      \n      <ul>\n        <li\n          v-for=\"(c, index) in carmera_list\"\n          :key=\"index\"\n          :class=\"{ active: c.image_display, cut: c.nosignal }\"\n          class=\"carmera_lists\"\n        >\n          <div class=\"strapline\">\n            <dl>\n              <dt><input type=\"text\" :value=\"c.location\" /></dt>\n              <dd v-if=\"c.nosignal === true\">\n                <font-awesome-icon icon=\"exclamation-triangle\" />\n              </dd>\n              <dd><input type=\"text\" :value=\"c.direction\" /></dd>\n            </dl>\n          </div>\n          <div class=\"state_body_wrp\">\n            <ul class=\"state_body\">\n              <li :class=\"{ active: toggle, openfix:c.openfix }\" @click=\"toggles()\">\n                <div class=\"img_record\">                  \n                  <img :src=\"c.image_name\" alt=\"\" />                 \n                  <span class=\"open\"></span>\n                  <span class=\"fixing\"\n                    ><font-awesome-icon icon=\"lock\" /></span\n                  >\n                </div>\n                <p> : {{ c.lp }}</p>\n              </li>\n            </ul>\n            <div class=\"bt_control_wrap\">\n            <div class=\"bar_control\" v-if=\"c.barrier_control_display\">\n              <button class=\"button_open\" @click=\"bar_control(c)\"></button>\n              <button class=\"button_close\" @click=\"bar_control_close(c)\"></button>\n              <form>\n                <label>\n                  <input type=\"radio\" @click=\"bar_mode_lock(c)\" name=\"lock\" />\n                  <span><font-awesome-icon icon=\"lock\" /></span>\n                </label>\n                <label>\n                  <input\n                    type=\"radio\"\n                    @click=\"bar_mode_unlock(c)\"\n                    name=\"lock\"\n                    checked\n                  /><span> <font-awesome-icon icon=\"lock-open\" /></span>\n                </label>\n              </form>\n            </div>\n            <div class=\"bar_control\" v-else></div>\n            <div>\n              <ul class=\"checkbox-wrap\">\n                <li>\n                  <label\n                    ><input\n                      type=\"radio\"\n                      value=\"registered_vehicle\"\n                      v-model=\"c.checkedNames\"\n                      @change=\"bar_policy_fun(c)\"\n                    /> </label\n                  >\n                </li>\n                <li>\n                  <label\n                    ><input\n                      type=\"radio\"\n                      value=\"not_recg_vehicle\"\n                      v-model=\"c.checkedNames\"\n                      @change=\"bar_policy_fun(c)\"\n                    /> </label\n                  >\n                </li>\n                <li>\n                  <label\n                    ><input\n                      type=\"radio\"\n                      value=\"special_vehicle\"\n                      v-model=\"c.checkedNames\"\n                      @change=\"bar_policy_fun(c)\"\n                    /> </label\n                  >\n                </li>\n                <li>\n                  <label\n                    ><input\n                      type=\"radio\"\n                      value=\"all_vehicle\"\n                      v-model=\"c.checkedNames\"\n                      @change=\"bar_policy_fun(c)\"\n                    /> </label\n                  >\n                </li>\n              </ul>\n              <!--\t<span> : {{ c.checkedNames }}</span> -->\n            </div>\n            </div>\n          </div>\n          <!--\t<div style=\"position:relative\">\n\t\t\t\t\t\t<button style=\"outline:none;background:#ec6900;color:white;position:absolute;top:0;left:0\" @click=\"signal(c)\"></button>\n\t\t\t\t\t</div> -->\n        </li>\n      </ul>\n    </div>\n    <div class=\"record_wrap\">\n      <div class=\"menu_title\">\n        <div class=\"counting\">\n          <h2>  </h2>\n\n          <span>  : {{ total_parking_fee | currency }}, </span>\n          <span>  : {{ total_discounted_fee | currency }}, </span>\n          <span>  : {{ total_paid_fee | currency }} </span>\n          <span\n            ><font-awesome-icon icon=\"sign-out-alt\" />:{{\n              count_out\n            }}</span\n          >\n          <span\n            ><font-awesome-icon icon=\"sign-in-alt\" />:{{\n              count_in\n            }}</span\n          >\n        </div>\n      </div>\n      <div class=\"list_data\">\n        <table class=\"list_data_table\">\n          <thead>\n            <tr class=\"tableTitle\" colspan=\"11\">\n              <th class=\"number\"></th>\n              <th></th>\n              <th></th>\n              <th></th>\n              <th></th>\n              <th></th>\n              <th></th>\n              <th></th>\n              <th class=\"last_cont\"></th>\n            </tr>\n          </thead>\n          <tbody class=\"scrolltBody \">\n            <tr v-for=\"(d, index) in dataList\" :key=\"index\">\n              <td colspan=\"11\">\n                <table>\n                  <tr @click.prevent=\"open_picture(d)\">\n                    <td class=\"number\">{{ index + 1 }}</td>\n                    <td>\n                      <input\n                        type=\"text\"\n                        v-model=\"d.get_lp\"\n                        v-on:change=\"contents_change(index)\"\n                      />\n                    </td>\n                    <td>{{ d.get_time }}</td>\n                    <td>{{ d.get_location }}</td>\n                    <td>{{ d.get_direction }}</td>\n                    <td>{{ d.get_fee }}</td>\n                    <td>{{ d.get_discounted_fee }}</td>\n                    <td>{{ d.get_paid_fee }}</td>                    \n                    <td>\n                      <input\n                        type=\"text\"\n                        v-model=\"d.get_contents\"\n                        v-on:change=\"contents_change(index)\"\n                      />\n                    </td>\n                  </tr>\n                  <tr v-if=\"d.get_image_display === false\" @click=\"close_picture(d)\">\n                    <td colspan=\"11\" class=\"tdImg\">\n                      <div>\n                        <img :src=\"d.get_image_name\" alt=\"\" />\n                        <span>\n                          {{ d.get_location }}-{{ d.get_direction }}</span\n                        >\n                      </div>\n                    </td>\n                  </tr>\n                </table>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n </div>\n</template>\n<script>\nimport config from \"../../config.js\"\nimport { mapState } from \"vuex\"\nexport default {\n  data: function() {\n    return {\n      dataList: [{get_time:\"\",get_location:\"\",get_direction:\"\",get_lp:\"\",get_fee:\"\",get_discounted_fee:\"\",get_paid_fee:\"\",get_registered:\"\",get_contents:\"\"}],\n      carmera_list: [   {\n      kind_bar_status: \"barrier_status\",\n      kind_bar_policy: \"bar_ploicy\",\n      status: \"down\",\n      location: \"\",\n      direction: \"in\",\n      lp: \"1234567\",\n      image_display: false,\n      barrier_control_display: true,\n      barrier_policy_name: \"barrier_policy1\",\n      image_name: require(\"../../assets/car_test1.jpg\"),\n      checkedNames: \"all_vehicle\"\n    },\n    {\n      kind: \"barrier_status\",\n      status: \"down\",\n      location: \"\",\n      direction: \"out\",\n      lp: \"5461517\",\n      image_display: false,\n      barrier_control_display: true,\n      barrier_policy_name: \"barrier_policy2\",\n      image_name: require(\"../../assets/car_test2.jpg\"),\n      checkedNames: \"registered_vehicle\"     \n    }],\n      start_time: new Date(),\n      end_time: new Date(),\n      total_parking_fee: 0,\n      total_discounted_fee: 0,\n      total_paid_fee: 0,\n      toggle: false,\n      openfix: false,\n      nosignal: false,\n      list_items: {\n        time: \"\",\n        loop_event_time: \"pc\",\n        location: \"1\",\n        direction: \"In\",\n        lp: \"1234567\",\n        resistered: \"\",\n        dong_ho: \"101\",\n        image_display: false,\n        image_name: require(\"../../assets/car_test4.jpg\")\n      },\n      checked: [],\n      button_value: [\n        { name: \"\", checked: true },\n        { name: \"\", checked: false }\n      ]\n    }\n  },\n  filters: {\n    currency: function(value) {\n      var num = new Number(value)\n      return num.toFixed(0).replace(/(\\d)(?=(\\d{3})+(?:\\.\\d+)?$)/g, \"$1,\")\n    }\n  },\n  computed: {\n     ...mapState([\"mainTitle\"]),\n    count_in() {\n      let count = 0\n      this.dataList.forEach(cot => {\n        if (cot.get_direction === \"in\") count++\n      })\n      return count\n    },\n    count_out() {\n      let count = 0\n      this.dataList.forEach(cot => {\n        if (cot.get_direction === \"out\") count++\n      })\n      return count\n    }\n  },\n  created() {\n    this.$socket.on(\"message_from_server\", data => {         \n      this.lpr_process(data)\n    }),\n      this.barrier_name_check(),\n      // this.barrier_policy_query(),\n      //this.bar_status_query(),\n      this.start(),\n      this.vehicle_obj_list_find()\n  },\n  methods: {\n    lpr_process(data1) {\n      if (data1.kind === \"barrier_status\") {\n        console.log(\"barrier_status\", data1)\n        for (let i = 0; i < this.carmera_list.length; i++) {\n          if (data1.location == this.carmera_list[i].location) {\n            if (data1.status === \"down\" || data1.status === \"DOWN\") {\n              this.carmera_list[i].image_display = false\n              let temp = {}\n              this.carmera_list.push(temp)\n              this.carmera_list.splice(this.carmera_list.length - 1, 1)\n            } else {\n              this.carmera_list[i].image_display = true\n              let temp = {}\n              this.carmera_list.push(temp)\n              this.carmera_list.splice(this.carmera_list.length - 1, 1)\n            }\n          }\n        }\n      } else if (data1.kind === \"bar_mode\") {\n        console.log(\"bar_mode\", data1)\n        for (let j = 0; j < data1.docs.length; j++) {\n          let bar_mode = data1.docs[j]\n          for (let i = 0; i < this.carmera_list.length; i++) {\n            if (\n              bar_mode.location === this.carmera_list[i].location &&  bar_mode.direction === this.carmera_list[i].direction\n            ) {\n              \n              if (bar_mode.mode === \"lock\") {\n                this.carmera_list[i].openfix = true\n                let temp = {}\n                this.carmera_list.push(temp)\n                this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              } else {\n                this.carmera_list[i].openfix = false\n                let temp = {}\n                this.carmera_list.push(temp)\n                this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              }\n              break\n            }\n          }\n        }\n      } else if (data1.kind === \"bar_status\") {\n        console.log(\"bar_status\", data1)\n        for (let j = 0; j < data1.docs.length; j++) {\n          let bar_status = data1.docs[j]\n          for (let i = 0; i < this.carmera_list.length; i++) {\n            if (\n              bar_status.location === this.carmera_list[i].location &&\n              bar_status.direction == this.carmera_list[i].direction\n            ) {\n              if (data1.status === \"down\" || data1.status === \"DOWN\") {\n                this.carmera_list[i].image_display = false\n                let temp = {}\n                this.carmera_list.push(temp)\n                this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              } else if (data1.status === \"up\" || data1.status === \"UP\"){\n                this.carmera_list[i].image_display = true\n                let temp = {}\n                this.carmera_list.push(temp)\n                this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              }\n              break\n            }\n          }\n        }\n      } else if (data1.kind === \"socket_error\") {\n        //  console.log(\"socket error : \", data1)\n        for (let i = 0; i < this.carmera_list.length; i++) {\n          if (\n            data1.location === this.carmera_list[i].location &&\n            data1.direction === this.carmera_list[i].direction\n          ) {\n            this.carmera_list[i].nosignal = true\n            let temp = {}\n            this.carmera_list.push(temp)\n            this.carmera_list.splice(this.carmera_list.length - 1, 1)\n            //console.log(\"\", this.carmera_list[0].status)\n          }\n        }\n      } else if (data1.kind === \"weekly_barrier_policy\") {\n        for (let i = 0; i < this.carmera_list.length; i++) {\n          if (\n            data1.location === this.carmera_list[i].location &&\n            data1.direction === this.carmera_list[i].direction\n          ) {\n            if (data1.barrier_policy === \"\") {\n              this.carmera_list[i].checkedNames = \"all_vehicle\"\n              let temp = {}\n              this.carmera_list.push(temp)\n              this.carmera_list.splice(this.carmera_list.length - 1, 1)\n            } else {\n              for (let j = 0; j < config.barrier_display_list.length; j++) {\n                if (\n                  data1.location === config.barrier_display_list[j].location &&\n                  data1.direction === config.barrier_display_list[j].direction\n                ) {\n                  this.carmera_list[i].checkedNames =\n                    config.barrier_display_list[j].checkedNames\n                  let temp = {}\n                  this.carmera_list.push(temp)\n                  this.carmera_list.splice(this.carmera_list.length - 1, 1)\n                }\n              }\n            }\n          }\n        }\n      } else if (data1.kind === \"socket_normal\") {\n        // console.log(\"socket normal : \", data1)\n        for (let i = 0; i < this.carmera_list.length; i++) {\n          if (\n            data1.location === this.carmera_list[i].location &&\n            data1.direction === this.carmera_list[i].direction\n          ) {\n            this.carmera_list[i].nosignal = false\n            let temp = {}\n            this.carmera_list.push(temp)\n            this.carmera_list.splice(this.carmera_list.length - 1, 1)\n            //console.log(\"\", this.carmera_list[0].status)\n          }\n        }\n      } else if (data1.kind == \"lpr\") {\n        console.log(data1.kind, data1)\n        //var image_name = \"localhost:7200/images/\"+data1.folder_name+\"/\"+data1.filename\n        let image_name =\n          config.image_src + data1.folder_name + \"/\" + data1.filename\n        // console.log(\"image_name : \", image_name)\n        //\tconsole.log(\"dataList : \", this.dataList);\n        if (data1.direction === \"in\") {\n          data1.direction1 = \"in\"\n        } else {\n          data1.direction1 = \"out\"\n        }\n        let flag = false\n        for (let i = 0; i < this.dataList.length; i++) {\n          //console.log(this.dataList[i].get_loop_event_time, this.dataList[i].get_lp);\n          if (this.dataList[i].get_loop_event_time === data1.loop_event_time) {\n            if (data1.lp != \"\") {\n              //    \n              if (this.dataList[i].get_lp === \"\") {\n                this.dataList[i].get_lp = data1.lp\n                this.dataList[i].get_registered = data1.registered\n                this.dataList[i].get_direction = data1.direction1\n                this.dataList[i].get_contents = data1.contents\n                this.dataList[i].get_image_name = true\n                this.dataList[i].get_image_name = image_name\n                if (data1.direction === \"in\") {\n                  this.dataList[i].get_discounted_fee = 0\n                  this.dataList[i].get_paid_fee = 0\n                  this.dataList[i].get_fee = 0\n                } else {\n                  if (!data1.discounted_fee) {\n                    data1.discounted_fee = 0\n                  }\n                  if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n                    data1.fee = 0\n                  }\n                  if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n                    data1.paid_fee = 0\n                  }\n                  console.log(\"flag === true :\", data1)\n                  this.dataList[i].get_discounted_fee = parseInt(\n                    data1.discounted_fee,\n                    10\n                  )\n                  this.dataList[i].get_paid_fee = parseInt(data1.paid_fee, 10)\n                  this.dataList[i].get_fee = parseInt(data1.fee, 10)\n                }\n                for (let i = 0; i < this.carmera_list.length; i++) {\n                  //\tconsole.log(data1.lp, this.carmera_list[i].location, data1.location);\n                  if (data1.location === this.carmera_list[i].location && data1.direction === this.carmera_list[i].direction) {\n                    this.carmera_list[i].lp = data1.lp\n                    this.carmera_list[i].image_name = image_name\n                    let temp = {}\n                    this.carmera_list.push(temp)\n                    this.carmera_list.splice(this.carmera_list.length - 1, 1)\n                    break\n                  }\n                }\n              }\n            }\n            flag = true\n            break\n          }\n        }\n        if (flag == false) {\n          let temp = {}\n          temp.get_time = format_time(new Date(data1.loop_event_time))\n          temp.get_loop_event_time = data1.loop_event_time\n          temp.get_location = data1.location\n          temp.get_lp = data1.lp\n          temp.get_registered = data1.registered\n          temp.get_direction = data1.direction1\n          temp.get_contents = data1.contents\n          temp.get_image_display = true\n          temp.get_image_name = image_name\n          if (data1.direction === \"in\") {\n            temp.get_discounted_fee = 0\n            temp.get_paid_fee = 0\n            temp.get_fee = 0\n          } else {\n            if (!data1.discounted_fee) {\n              data1.discounted_fee = 0\n            }\n            if (!data1.fee) {\n              data1.fee = 0\n            }\n            if (!data1.paid_fee) {\n              data1.paid_fee = 0\n            }\n            temp.get_discounted_fee = parseInt(data1.discounted_fee, 10)\n            temp.get_paid_fee = parseInt(data1.paid_fee, 10)\n            temp.get_fee = parseInt(data1.fee, 10)\n            console.log(\"flag === false : \", data1)\n          }\n          this.dataList.unshift(temp)\n          for (let i = 0; i < this.carmera_list.length; i++) {\n            //\tconsole.log(data1.lp, this.carmera_list[i].location, data1.location);\n            if (data1.location === this.carmera_list[i].location && data1.direction === this.carmera_list[i].direction) {\n              this.carmera_list[i].lp = data1.lp\n              this.carmera_list[i].image_name = image_name\n              let temp = {}\n              this.carmera_list.push(temp)\n              this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              break\n            }\n          }\n        }\n        let total_parking_fee = 0\n        let total_discounted_fee = 0\n        let total_paid_fee = 0\n        for (let i = 0; i < this.dataList.length; i++) {\n          total_parking_fee += parseInt(this.dataList[i].get_fee, 10)\n          total_discounted_fee += parseInt(\n            this.dataList[i].get_discounted_fee,\n            10\n          )\n          total_paid_fee += parseInt(this.dataList[i].get_paid_fee, 10)\n        }\n        this.total_parking_fee = total_parking_fee\n        this.total_discounted_fee = total_discounted_fee\n        this.total_paid_fee = total_paid_fee\n        //\tconsole.log(this.carmera_list.length);\n      } else if (data1.kind == \"fee_calculation_result\") {\n        console.log(data1.kind, data1)\n        //var image_name = \"localhost:7200/images/\"+data1.folder_name+\"/\"+data1.filename\n        let image_name =\n          config.image_src + data1.folder_name + \"/\" + data1.filename\n        // console.log(\"image_name : \", image_name)\n        //\tconsole.log(\"dataList : \", this.dataList);\n        if (data1.direction === \"in\") {\n          data1.direction1 = \"\"\n        } else {\n          data1.direction1 = \"\"\n        }\n        let flag = false\n        for (let i = 0; i < this.dataList.length; i++) {\n          //console.log(this.dataList[i].get_loop_event_time, this.dataList[i].get_lp);\n          if (this.dataList[i].get_loop_event_time === data1.loop_event_time) {\n            this.dataList[i].get_lp = data1.lp\n            this.dataList[i].get_registered = data1.registered\n            this.dataList[i].get_direction = data1.direction\n            this.dataList[i].get_contents = data1.contents\n            this.dataList[i].get_image_name = true\n            this.dataList[i].get_image_name = image_name\n            if (data1.direction === \"in\") {\n              this.dataList[i].get_discounted_fee = 0\n              this.dataList[i].get_paid_fee = 0\n              this.dataList[i].get_fee = 0\n            } else {\n              if (!data1.discounted_fee) {\n                data1.discounted_fee = 0\n              }\n              if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n                data1.fee = 0\n              }\n              if (!data1.paid_fee) {\n                data1.paid_fee = 0\n              }\n              this.dataList[i].get_discounted_fee = parseInt(\n                data1.discounted_fee,\n                10\n              )\n              this.dataList[i].get_paid_fee = parseInt(data1.paid_fee, 10)\n              this.dataList[i].get_fee = parseInt(data1.fee, 10)\n            }\n            flag = true\n            break\n          }\n        }\n        if (flag == false) {\n          let temp = {}\n          temp.get_time = format_time(new Date(data1.loop_event_time))\n          temp.get_loop_event_time = data1.loop_event_time\n          temp.get_location = data1.location\n          temp.get_lp = data1.lp\n          temp.get_registered = data1.registered\n          temp.get_direction = data1.direction\n          temp.get_contents = data1.contents\n          temp.get_image_display = true\n          temp.get_image_name = image_name\n          if (data1.direction === \"in\") {\n            temp.get_discounted_fee = 0\n            temp.get_paid_fee = 0\n            temp.get_fee = 0\n          } else {\n            if (!data1.discounted_fee) {\n              data1.discounted_fee = 0\n            }\n            if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n              data1.fee = 0\n            }\n            if (!data1.paid_fee) {\n              data1.paid_fee = 0\n            }\n            temp.get_discounted_fee = data1.discounted_fee\n            temp.get_paid_fee = data1.paid_fee\n            temp.get_fee = data1.fee\n          }\n          this.dataList.unshift(temp)\n        }\n        let total_parking_fee = 0\n        let total_discounted_fee = 0\n        let total_paid_fee = 0\n        for (let i = 0; i < this.dataList.length; i++) {\n          total_parking_fee += parseInt(this.dataList[i].get_fee, 10)\n          total_discounted_fee += parseInt(\n            this.dataList[i].get_discounted_fee,\n            10\n          )\n          total_paid_fee += parseInt(this.dataList[i].get_paid_fee, 10)\n        }\n        this.total_parking_fee = total_parking_fee\n        this.total_discounted_fee = total_discounted_fee\n        this.total_paid_fee = total_paid_fee\n        //\tconsole.log(this.carmera_list.length);\n      } else if (data1.kind == \"lpr_payment\") {\n          console.log(data1.kind, data1)\n        //var image_name = \"localhost:7200/images/\"+data1.folder_name+\"/\"+data1.filename\n        let image_name =\n          config.image_src + data1.folder_name + \"/\" + data1.filename\n        //  console.log(\"image_name : \", image_name)\n        //\tconsole.log(\"dataList : \", this.dataList);\n        if (data1.direction === \"in\") {\n          data1.direction1 = \"in\"\n        } else {\n          data1.direction1 = \"out\"\n        }\n        let flag = false\n        for (let i = 0; i < this.dataList.length; i++) {\n          //console.log(this.dataList[i].get_loop_event_time, this.dataList[i].get_lp);\n          if (this.dataList[i].get_loop_event_time === data1.loop_event_time) {\n            this.dataList[i].get_lp = data1.lp\n            this.dataList[i].get_registered = data1.registered\n            this.dataList[i].get_direction = data1.direction\n            this.dataList[i].get_contents = data1.contents\n            this.dataList[i].get_image_name = true\n            this.dataList[i].get_image_name = image_name\n            if (data1.direction === \"in\") {\n              this.dataList[i].get_discounted_fee = 0\n              this.dataList[i].get_paid_fee = 0\n              this.dataList[i].get_fee = 0\n            } else {\n              if (!data1.discounted_fee) {\n                data1.discounted_fee = 0\n              }\n              if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n                data1.fee = 0\n              }\n              if (!data1.paid_fee) {\n                data1.paid_fee = 0\n              }\n              this.dataList[i].get_discounted_fee = data1.discounted_fee\n              this.dataList[i].get_paid_fee = data1.paid_fee\n              this.dataList[i].get_fee = data1.fee\n            }\n            flag = true\n            break\n          }\n        }\n        if (flag == false) {\n          let temp = {}\n          temp.get_time = format_time(new Date(data1.loop_event_time))\n          temp.get_loop_event_time = data1.loop_event_time\n          temp.get_location = data1.location\n          temp.get_lp = data1.lp\n          temp.get_registered = data1.registered\n          temp.get_direction = data1.direction\n          temp.get_contents = data1.contents\n          temp.get_image_display = true\n          temp.get_image_name = image_name\n          if (data1.direction === \"in\") {\n            temp.get_discounted_fee = 0\n            temp.get_paid_fee = 0\n            temp.get_fee = 0\n          } else {\n            if (!data1.discounted_fee) {\n              data1.discounted_fee = 0\n            }\n            if (!data1.fee || data1.fee === 9998 || data1.fee === 9999) {\n              data1.fee = 0\n            }\n            if (!data1.paid_fee) {\n              data1.paid_fee = 0\n            }\n            temp.get_discounted_fee = data1.discounted_fee\n            temp.get_paid_fee = data1.paid_fee\n            temp.get_fee = data1.fee\n          }\n          this.dataList.unshift(temp)\n        }\n        let total_parking_fee = 0\n        let total_discounted_fee = 0\n        let total_paid_fee = 0\n        for (let i = 0; i < this.dataList.length; i++) {\n          total_parking_fee += parseInt(this.dataList[i].get_fee, 10)\n          total_discounted_fee += parseInt(\n            this.dataList[i].get_discounted_fee,\n            10\n          )\n          total_paid_fee += parseInt(this.dataList[i].get_paid_fee, 10)\n        }\n        this.total_parking_fee = total_parking_fee\n        this.total_discounted_fee = total_discounted_fee\n        this.total_paid_fee = total_paid_fee\n        //\tconsole.log(this.carmera_list.length);\n      } else if (\n        data1.kind === \"barrier_policy_query\" ||\n        data1.kind === \"get_barrier_policy_query\"\n      ) {\n        console.log(\"data1_barrier_policy_query : \", data1)\n        //console.log(\"data1_docs[0] : \", data1.docs[0], data1.docs[1], data1.docs.length, this.carmera_list.length);\n        if (\n          data1.docs &&\n          data1.docs.length > 0 &&\n          this.carmera_list.length > 0\n        ) {\n          for (let i = 0; i < data1.docs.length; i++) {\n            let direction = \"out\"\n            if (data1.docs[i].direction === \"in\") {\n              direction = \"in\"\n            }\n            // console.log(\"barrier_policy_query obj : \", data1.docs[i].location, this.carmera_list[0].location, this.carmera_list[1].location)\n            for (let j = 0; j < this.carmera_list.length; j++) {\n              if (\n                this.carmera_list[j].location === data1.docs[i].location &&\n                this.carmera_list[j].direction === direction\n              ) {\n                this.carmera_list[j].checkedNames = data1.docs[i].value\n                //console.log( \"data1_barrier_policy_query : \", this.carmera_list[j])\n                let temp = {}\n                this.carmera_list.push(temp)\n                this.carmera_list.splice(this.carmera_list.length - 1, 1)\n                break\n              }\n            }\n          }\n        }\n      } else if (data1.kind === \"get_vehicle_obj_list\") {\n        //   console.log(\"get_vehicle_obj_list : \", data1)\n        for (let i = 0; i < data1.docs.length; i++) {\n          let obj = data1.docs[i]\n          let image_name =\n            config.image_src + obj.folder_name + \"/\" + obj.filename\n          //  console.log(\"image_name : \", image_name)\n          //\tconsole.log(\"dataList : \", this.dataList);\n          if (obj.direction === \"in\") {\n            obj.direction1 = \"\"\n          } else {\n            obj.direction1 = \"\"\n          }\n          let flag = false\n          let total_parking_fee = 0\n          let total_discounted_fee = 0\n          let total_paid_fee = 0\n          for (let i = 0; i < this.dataList.length; i++) {\n            //console.log(this.dataList[i].get_loop_event_time, this.dataList[i].get_lp);\n            if (this.dataList[i].get_loop_event_time === obj.loop_event_time) {\n              if (\n                obj.lp != \"\" &&\n                obj.lp.indexOf(\"X\") < 0 &&\n                obj.lp.length >= 7\n              ) {\n                //    \n                if (\n                  this.dataList[i].get_lp == \"\" ||\n                  this.dataList[i].get_lp.indexOf(\"X\") >= 0 ||\n                  this.dataList[i].get_lp.length < 7\n                ) {\n                  this.dataList[i].get_lp = obj.lp\n                  this.dataList[i].get_registered = obj.registered\n                  this.dataList[i].get_direction = obj.direction\n                  this.dataList[i].get_contents = obj.contents\n                  this.dataList[i].get_image_name = true\n                  this.dataList[i].get_image_name = image_name\n                  if (obj.direction === \"in\") {\n                    this.dataList[i].get_discounted_fee = 0\n                    this.dataList[i].get_paid_fee = 0\n                    this.dataList[i].get_fee = 0\n                  } else {\n                    if (!obj.discounted_fee) {\n                      obj.discounted_fee = 0\n                    }\n                    if (!data1.fee || obj.fee === 9998 || obj.fee === 9999) {\n                      obj.fee = 0\n                    }\n                    if (!obj.paid_fee) {\n                      obj.paid_fee = 0\n                    }\n                    this.dataList[i].get_discounted_fee = obj.discounted_fee\n                    this.dataList[i].get_paid_fee = obj.paid_fee\n                    this.dataList[i].get_fee = obj.fee\n                    total_parking_fee += parseInt(obj.fee, 10)\n                    total_discounted_fee += parseInt(obj.discounted_fee, 10)\n                    total_paid_fee += parseInt(obj.paid_fee, 10)\n                  }\n                }\n              }\n              flag = true\n              break\n            }\n          }\n          if (flag == false) {\n            let temp = {}\n            temp.get_time = format_time(new Date(obj.loop_event_time))\n            temp.get_loop_event_time = obj.loop_event_time\n            temp.get_location = obj.location\n            temp.get_lp = obj.lp\n            temp.get_registered = obj.registered\n            temp.get_direction = obj.direction\n            temp.get_contents = obj.contents\n            temp.get_image_display = true\n            temp.get_image_name = image_name\n            if (data1.direction === \"in\") {\n              temp.get_discounted_fee = 0\n              temp.get_paid_fee = 0\n              temp.get_fee = 0\n            } else {\n              if (!obj.discounted_fee) {\n                obj.discounted_fee = 0\n              }\n              if (!obj.fee || obj.fee === 9998 || obj.fee === 9999) {\n                obj.fee = 0\n              }\n              if (!obj.paid_fee) {\n                obj.paid_fee = 0\n              }\n              temp.get_discounted_fee = obj.discounted_fee\n              temp.get_paid_fee = obj.paid_fee\n              temp.get_fee = obj.fee\n              total_parking_fee += parseInt(obj.fee, 10)\n              total_discounted_fee += parseInt(obj.discounted_fee, 10)\n              total_paid_fee += parseInt(obj.paid_fee, 10)\n            }\n            this.dataList.unshift(temp)\n          }\n          this.total_parking_fee += total_parking_fee\n          this.total_discounted_fee += total_discounted_fee\n          this.total_paid_fee += total_paid_fee\n          // console.log(\n          //   \"total_parking_fee :\",\n          //   total_parking_fee,\n          //   \"total_discounted_fee :\",\n          //   total_discounted_fee,\n          //   \"total_paid_fee: \",\n          //   total_paid_fee\n          // )\n          for (let i = 0; i < this.carmera_list.length; i++) {\n            //\tconsole.log(data1.lp, this.carmera_list[i].location, data1.location);\n            if (\n              obj.location == this.carmera_list[i].location &&\n              obj.direction == this.carmera_list[i].direction\n            ) {\n              this.carmera_list[i].lp = obj.lp\n              this.carmera_list[i].image_name = image_name\n              let temp = {}\n              this.carmera_list.push(temp)\n              this.carmera_list.splice(this.carmera_list.length - 1, 1)\n              break\n            }\n          }\n        }\n      }\n    },\n    contents_change(index) {\n      // console.log(\" :\", this.dataList[index])\n      var obj = {}\n      // obj.kind = \"update_vehicle_obj_at_vehicle_obj_list\"\n      obj.kind1 = \"update_vehicle_obj_at_vehicle_obj_list\"\n      obj.lp = this.dataList[index].get_lp\n      obj.loop_event_time = this.dataList[index].get_loop_event_time\n      obj.contents = this.dataList[index].get_contents\n      obj.number = obj.lp.replace(/[-]/gi, \"\")\n      this.sendMessage(obj)\n    },\n    vehicle_obj_list_find() {\n      let d = new Date()\n      //let d1 = d - (24*60*60*1000);\n      //console.log(\"d : \", d, \" d1 : \", d1);\n      let str_start =\n        d.getFullYear() +\n        \"-\" +\n        itoStr(d.getMonth() + 1) +\n        \"-\" +\n        itoStr(d.getDate()) +\n        \"T00:00\"\n      let str_end =\n        d.getFullYear() +\n        \"-\" +\n        itoStr(d.getMonth() + 1) +\n        \"-\" +\n        itoStr(d.getDate()) +\n        \"T23:59\"\n      this.start_time = str_start\n      this.end_time = str_end\n      let obj = {}\n      obj.start_time = get_start_time(this.start_time)\n      obj.end_time = get_end_time(this.end_time)\n      obj.kind = \"get_vehicle_obj_list\"\n      obj.id = window.localStorage.getItem(\"admin_id\")\n      obj.pw = window.localStorage.getItem(\"admin_pw\")\n      // console.log(\"lp_search() : \", obj)\n      this.sendMessage(obj)\n    },\n    signal(c) {\n      c.image_display = !c.image_display\n    },\n    toggles() {\n      this.toggle = !this.toggle\n      //  console.log(this.toggle)\n    },\n    open_picture(d) {      \n      // d.get_image_display = false\n      d.get_image_display = !d.get_image_display\n     \n    },\n    close_picture(d) {\n      //  console.log(\"close_picture : \", d.get_image_display)\n      //this.$nextTick(function(){\n      return (d.get_image_display = true)\n      //})\n    },\n    bar_control(c) {\n      let obj = {}\n      obj.kind = \"control\"\n      obj.direction = \"up\"\n      obj.location = c.location\n      //index = c.index\n      //admin_id: \"admin001\"\n      this.sendMessage(obj)\n    },\n    bar_control_close(c) {\n      let obj = {}\n      obj.kind = \"\"\n      obj.direction = \"\"\n      obj.location = c.location\n      //index = c.index\n      //admin_id: \"admin001\"\n      this.sendMessage(obj)\n    },\n    bar_mode_lock(c) {\n      let obj = {}\n      obj.kind = \"mode\"\n      obj.mode = \"lock\"\n      obj.location = c.location\n      //index = c.index\n      //admin_id: \"admin001\"\n      this.sendMessage(obj)\n    },\n    bar_mode_unlock(c) {\n      let obj = {}\n      obj.kind = \"mode\"\n      obj.mode = \"unlock\"\n      obj.location = c.location\n      //index = c.index\n      //admin_id: \"admin001\"\n      this.sendMessage(obj)\n    },\n\n    bar_policy_fun(c) {\n      let obj = {}\n      let direction = \"out\"\n      if (c.direction === \"in\") {\n        direction = \"in\"\n      }\n      obj.cmd = \"update_barrier_policy\"\n      obj.kind = \"barrier_policy\"\n      obj.location = c.location\n      obj.direction = direction\n      obj.value = c.checkedNames\n      obj.time = Date.now()\n      //admin_id: \"admin001\"\n      // console.log(\"bar_policy_fun : \", obj)\n      this.sendMessage(obj)\n    },\n    barrier_name_check() {\n      this.carmera_list = []\n      for (let i = 0; i < config.barrier_display_list.length; i++) {\n        this.carmera_list.push(config.barrier_display_list[i])\n      }\n      // this.bar_policy_fun_all()\n    },\n    sendMessage(c) {\n      this.$socket.emit(\"message_from_web_client\", c)\n    },\n    start() {\n      //console.log(\"start   \");\n      let that = this\n      let flag = false\n      setInterval(() => {\n        let date = Date.now()\n        let temp_date = format_time_date(new Date(date)).split(\":\")\n        let temp_hh = parseInt(temp_date[0], 10)\n        let temp_mm = parseInt(temp_date[1], 10)\n        if (flag === false && temp_hh === 0 && temp_mm === 0) {\n          that.dataList = []\n          flag = true\n        } else {\n          flag = false\n        }\n      },20 * 1000)\n      this.bar_status_query()\n      this.barrier_policy_query()\n    },\n    bar_status_query() {\n      var obj = {}\n      obj.kind = \"bar_status\"\n      obj.control_id = \"admin001\"\n      console.log(\"bar_status_query\")\n      this.sendMessage(obj)\n    },\n    barrier_policy_query() {\n      var obj = {}\n      obj.kind = \"get_barrier_policy_query\"\n      obj.control_id = \"admin001\"\n      console.log(\"barrier_policy_query\")\n      // console.log(\"barrier_policy_query :\", obj)\n      this.sendMessage(obj)\n    }\n  }\n}\nfunction get_start_time(str) {\n  var res = str.split(/[-T.:\\s]+/)\n  var d = new Date(\n    parseInt(res[0]),\n    parseInt(res[1]) - 1,\n    parseInt(res[2]),\n    parseInt(res[3]),\n    parseInt(res[4]),\n    0,\n    0\n  )\n  return d.getTime()\n}\n\nfunction get_end_time(str) {\n  var res = str.split(/[-T.:\\s]+/)\n  var d = new Date(\n    parseInt(res[0]),\n    parseInt(res[1]) - 1,\n    parseInt(res[2]),\n    parseInt(res[3]),\n    parseInt(res[4]),\n    59,\n    999\n  )\n  return d.getTime()\n}\n// function format_time_date(dat) {\n//   var str = \"\"\n//   str += num_to_str(dat.getHours())\n//   str += \":\" + num_to_str(dat.getMinutes())\n//   str += \":\" + num_to_str(dat.getSeconds())\n//   return str\n// }\n\nfunction num_to_str($num) {\n  $num < 10 ? ($num = \"0\" + $num) : $num\n  return $num.toString()\n}\nfunction format_time_date(dat) {\n  var str = \"\"\n  str += num_to_str(dat.getHours())\n  str += \":\" + num_to_str(dat.getMinutes())\n  str += \":\" + num_to_str(dat.getSeconds())\n  return str\n}\nfunction itoStr($num) {\n  $num < 10 ? ($num = \"0\" + $num) : $num\n  return $num.toString()\n}\nfunction format_time(dat) {\n  var str = \"\"\n  str += dat.getFullYear()\n  str += \".\" + num_to_str(dat.getMonth() + 1)\n  str += \".\" + num_to_str(dat.getDate())\n  str += \". \" + num_to_str(dat.getHours())\n  str += \":\" + num_to_str(dat.getMinutes())\n  str += \":\" + num_to_str(dat.getSeconds())\n  return str\n}\n</script>\n<style scoped>\n/* @import \"../../assets/css/table.css\"; */\n/* @import \"../../assets/css/vehicleEntryExitLive.css\"; */\n\n</style>\n"]}]}